<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>MongodbåŸºç¡€ | Rex</title>
<meta name="keywords" content="NoSQL" />
<meta name="description" content="MongodbåŸºç¡€">
<meta name="author" content="Rex">
<link rel="canonical" href="https://rex0520.github.io/posts/nosql/mongodb/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.css" rel="preload stylesheet" as="style">
<link rel="preload" href="http://cdn.rexweb.xyz/img/20210821105340.png" as="image">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.js" onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://rex0520.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://rex0520.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://rex0520.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://rex0520.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://rex0520.github.io/%3Clink%20/%20abs%20url%3E">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.87.0" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="MongodbåŸºç¡€" />
<meta property="og:description" content="MongodbåŸºç¡€" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://rex0520.github.io/posts/nosql/mongodb/" /><meta property="og:image" content="https://cdn.rexweb.xyz/img/20210820141535.jpg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-09T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2021-07-09T00:00:00&#43;00:00" /><meta property="og:site_name" content="RexHub" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://cdn.rexweb.xyz/img/20210820141535.jpg"/>

<meta name="twitter:title" content="MongodbåŸºç¡€"/>
<meta name="twitter:description" content="MongodbåŸºç¡€"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://rex0520.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "MongodbåŸºç¡€",
      "item": "https://rex0520.github.io/posts/nosql/mongodb/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "MongodbåŸºç¡€",
  "name": "MongodbåŸºç¡€",
  "description": "MongodbåŸºç¡€",
  "keywords": [
    "NoSQL"
  ],
  "articleBody": "MongoDB ç®€ä»‹ï¼š   MongoDBæ˜¯ä¸ºå¿«é€Ÿå¼€å‘äº’è”ç½‘Webåº”ç”¨è€Œè®¾è®¡çš„æ•°æ®åº“ç³»ç»Ÿã€‚ MongoDBçš„è®¾è®¸ç›®æ ‡æ˜¯æç®€ã€çµæ´»ã€ä½œä¸ºWebåº”ç”¨æ ˆçš„ä¸€éƒ¨åˆ†ã€‚ MongoDBçš„æ•°æ®æ¨¡å‹æ˜¯é¢å‘æ–‡æ¡£çš„,æ‰€è°“æ–‡æ¡£æ˜¯- - -ç§ç±»ä¼¼äºJSONçš„ç»“æ„,ç®€å•ç†è§£MongoDBè¿™ä¸ªæ•°æ®åº“ä¸­å­˜çš„æ˜¯å„ç§å„æ ·çš„JSONã€‚ ( BSON )   ä¸‰ä¸ªæ¦‚å¿µ   æ•°æ®åº“( database )\n æ•°æ®åº“æ˜¯-ä¸ªä»“åº“,åœ¨ä»“åº“ä¸­å¯ä»¥å­˜æ”¾é›†åˆã€‚\n   é›†åˆ( collection )\n é›†åˆç±»ä¼¼äºæ•°ç»„,åœ¨é›†åˆä¸­å¯ä»¥å­˜æ”¾æ–‡æ¡£ã€‚\n   æ–‡æ¡£( dotument )\n æ–‡æ¡£æ•°æ®åº“ä¸­çš„æœ€å°å•ä½,æˆ‘ä»¬å­˜å‚¨å’Œæ“ä½œçš„ å†…å®¹éƒ½æ˜¯æ–‡æ¡£ã€‚\n   åŸºæœ¬æŒ‡ä»¤   show dbs\n æ˜¾ç¤ºå½“å‰çš„æ‰€æœ‰æ•°æ®åº“\n   use æ•°æ®åº“å\n è¿›å…¥æŒ‡å®šçš„æ•°æ®åº“ä¸­\n   db\n æ˜¾ç¤ºå½“å‰æ‰€å¤„çš„æ•°æ®åº“\n   show collections\n æ˜¾ç¤ºæ•°æ®åº“ä¸­æ‰€æœ‰çš„é›†åˆ\n   db..insert(doc)\n å‘é›†åˆä¸­æ’å…¥ä¸€ä¸ªæ–‡æ¡£\n   db..find()\n æŸ¥çœ‹æ•°æ®åº“å­—æ®µ\n   æ’å…¥æ–‡æ¡£ /* å‘æ•°æ®åº“æ’å…¥æ–‡æ¡£\tdb..insert( ï¼Œ { wirteConcern: , ordered:  } ) documents: å¿…å¡«ï¼Œè¡¨ç¤ºéœ€è¦æ’å…¥çš„æ–‡æ¡£ï¼Œå¯ä»¥æ˜¯å¤šä¸ªæ–‡æ¡£ writeConcernï¼šå¯é€‰é¡¹ï¼Œå†™ç­–ç•¥ orderedï¼šå¯é€‰ï¼Œè¡¨ç¤ºå¤šä¸ªæ–‡æ¡£æ˜¯å¦æŒ‰ç…§æ–‡æ¡£é¡ºåºå†™å…¥ -- å‘é›†åˆä¸­æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡æ¡£ -- å½“æˆ‘ä»¬å‘é›†åˆä¸­æ’å…¥æ–‡æ¡£æ—¶ï¼Œå¦‚æœæ²¡æœ‰ç»™æ–‡æ¡£æŒ‡å®š_idå±æ€§ï¼Œåˆ™æ•°æ®åº“ä¼šè‡ªåŠ¨ä¸ºæ–‡æ¡£æ·»åŠ _idï¼Œ è¯¥å±æ€§ç”¨æ¥ä½œä¸ºæ–‡æ¡£çš„å”¯ä¸€æ ‡è¯† -- _idå¯ä»¥è‡ªå·±æŒ‡å®šï¼Œå¦‚æœæŒ‡å®šäº†æ•°æ®åº“å°±ä¸ä¼šå†æ·»åŠ äº†ï¼Œå¦‚æœè‡ªå·±æŒ‡å®š_idï¼Œä¹Ÿå¿…é¡»ç¡®ä¿ä»–çš„å”¯ä¸€æ€§ db.collection.insertOne() -- æ’å…¥ä¸€ä¸ªæ–‡æ¡£å¯¹è±¡ db.collection.insertMany() -- æ’å…¥å¤šä¸ªæ–‡æ¡£å¯¹è±¡ */db.stus.insert({name:\"zhubajie\",age:28,gender:\"ç”·\"})db.stus.insert([{name:\"shasen\",age:38,gender:\"ç”·\"},{name:\"baigujing\",age:16,gender:\"å¥³\"},{name:\"zhizhujing\",age:14,gender:\"å¥³\"}])æŸ¥è¯¢æ–‡æ¡£ æŸ¥è¯¢é€‰æ‹©å™¨    è¿ç®—ç¬¦ç±»å‹ è¿ç®—ç¬¦ è¿ç®—ç¬¦å«ä¹‰     â€”â€”â€”â€”â€”â€” $eq ç­‰äº    $lt å°äº   æ¯” $lte å°äºç­‰äº    $gt å¤§äº    $gte å¤§äºç­‰äº   è¾ƒ $in åˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨æŒ‡å®šçš„é›†åˆèŒƒå›´é‡Œ    $all åˆ¤æ–­å…ƒç´ æ˜¯å¦ä¸åœ¨æŒ‡å®šçš„é›†åˆèŒƒå›´é‡Œ    $nin åˆ¤æ–­å…ƒç´ æ˜¯å¦ä¸åœ¨æŒ‡å®šçš„èŒƒå›´é‡Œ   â€”â€”â€”â€”â€”â€” $ne ä¸ç­‰äº   â€”â€”â€”â€”â€”â€” $not ä¸åŒ¹é…ç»“æœ   é€»è¾‘ $or æœ‰ä¸€ä¸ªæ¡ä»¶æˆç«‹åˆ™åŒ¹é…    $nor æ‰€æœ‰æ¡ä»¶éƒ½å¿…é¡»åŒ¹é…   è¿ç®— $and æ‰€æœ‰æ¡ä»¶éƒ½å¿…é¡»åŒ¹é…   â€”â€”â€”â€”â€”â€” $exists åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨   å…¶ . å­æ–‡æ¡£åŒ¹é…   ä»– $regex æ­£åˆ™è¡¨è¾¾å¼    ä¸€èˆ¬æŸ¥è¯¢ /* æŸ¥è¯¢ db.collection.find() -- find()ç”¨æ¥æŸ¥è¯¢æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£ -- find()å¯ä»¥æ¥å—ä¸€ä¸ªå¯¹è±¡ä½œä¸ºæ¡ä»¶å‚æ•° {} è¡¨ç¤ºæŸ¥è¯¢é›†åˆä¸­æ‰€æœ‰çš„æ–‡æ¡£ {å±æ€§ï¼šå€¼} æŸ¥è¯¢å±æ€§æ˜¯æŒ‡å®šçš„æ–‡æ¡£ -- find() è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„ db.collection.findOne() -- ç”¨æ¥æŸ¥è¯¢é›†åˆä¸­ç¬¦åˆæ¡ä»¶çš„ç¬¬ä¸€ä¸ªæ–‡æ¡£ -- findOne() è¿”å›çš„æ˜¯ä¸€ä¸ªæ–‡æ¡£å¯¹è±¡ db.collection.find({}).count() -- æŸ¥è¯¢æ‰€æœ‰ç»“æœçš„æ•°é‡ */db.stus.insert({_id:\"hello\",name:\"zhubajie\",age:28,gender:\"ç”·\"})db.stus.find({age:28})db.stus.findOne({age:28}).namedb.stus.find({}).count()æŸ¥è¯¢å…¶ä»–æ¡ä»¶ æ˜ å°„  å­—æ®µé€‰æ‹©ï¼šdb.inventory.find({}, {â€˜itemâ€™: 1}) å­—æ®µæ’é™¤ï¼šdb.inventory.find({}, {â€˜itemâ€™: 0})  æ•°ç»„å­å…ƒç´ é€‰æ‹©ï¼š  db.inventory.find({}, {â€˜favorites.moviesâ€™: {'$slice': [1, 2]}, â€˜favorites.citesâ€™: 1}), $sliceå¯ä»¥å–ä¿©ä¸ªå…ƒç´ æ•°ç»„ï¼Œåˆ†åˆ«è¡¨ç¤ºè·³è¿‡å’Œé™åˆ¶çš„æ¡æ•°  æ’åº  sort(): db.orders.find().sort({â€˜orderTimeâ€™: 1, â€˜priceâ€™: 1}) 1: å‡åº 2: é™åº  è·³è¿‡å’Œé™åˆ¶   skip(n):è·³è¿‡næ¡æ•°æ®\n  limit(n):é™åˆ¶næ¡æ•°æ®\ne.gï¼šorders.find().sort({â€˜orderTimeâ€™: -1}).limit(5).skip(5)\n  æŸ¥è¯¢å”¯ä¸€å€¼   distinct()ï¼šæŸ¥è¯¢æŒ‡å®šå­—æ®µçš„å”¯ä¸€å€¼\ne.gï¼šdb.users.distinct(â€œageâ€)\n  èšåˆæŸ¥è¯¢  æˆ‘ä»¬åœ¨æŸ¥è¯¢æ—¶è‚¯å®šå›ç”¨åˆ°èšåˆï¼Œåœ¨MongoDBä¸­èšåˆä¸ºaggregateï¼Œèšåˆå‡½æ•°ä¸»è¦ç”¨åˆ°$matchï¼Œ$groupï¼Œ$avgï¼Œ$projectï¼Œ$concatï¼Œå¯ä»¥åŠ \"$match\"ä¹Ÿå¯ä»¥ä¸åŠ $match\n    è¡¨è¾¾å¼ æè¿°     $sum è®¡ç®—æ€»å’Œ   $avg è®¡ç®—å¹³å‡å€¼   $min è·å–é›†åˆä¸­æ‰€æœ‰æ–‡æ¡£å¯¹åº”å€¼çš„æœ€å°å€¼   $max è·å–é›†åˆä¸­æ‰€æœ‰æ–‡æ¡£å¯¹åº”å€¼çš„æœ€å¤§å€¼   $push åœ¨ç»“æœæ–‡æ¡£ä¸­æ’å…¥å€¼åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ã€‚   $addToSet åœ¨æ–‡æ¡£ä¸­æ’å…¥å€¼åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œä½†ä¸åˆ›å»ºå‰¯æœ¬ã€‚   $first æ ¹æ®èµ„æºæ–‡æ¡£çš„æ’åºè·å–ç¬¬ä¸€ä¸ªæ–‡æ¡£æ•°æ®ã€‚   $last æ ¹æ®èµ„æºæ–‡æ¡£çš„æ’åºè·å–æœ€åä¸€ä¸ªæ–‡æ¡£æ•°æ®ã€‚    Aggregateè¯­æ³•  åŸºæœ¬æ ¼å¼ï¼š db.collection.aggregate(pipeline, options)\nå‚æ•°è¯´æ˜ï¼š\n   å‚æ•° ç±»å‹ æè¿°     pipeline array ä¸€ç³»åˆ—æ•°æ®èšåˆæ“ä½œæˆ–é˜¶æ®µã€‚åœ¨ç‰ˆæœ¬2.6ä¸­æ›´æ”¹ï¼šè¯¥æ–¹æ³•ä»ç„¶å¯ä»¥å°†æµæ°´çº¿é˜¶æ®µä½œä¸ºå•ç‹¬çš„å‚æ•°æ¥å—ï¼Œè€Œä¸æ˜¯ä½œä¸ºæ•°ç»„ä¸­çš„å…ƒç´ ï¼›ä½†æ˜¯å¦‚æœä¸å°†ç®¡é“æŒ‡å®šä¸ºæ•°ç»„ï¼Œåˆ™ä¸èƒ½æŒ‡å®šoptionså‚æ•°ã€‚   options document å¯é€‰ã€‚aggregate()ä¼ é€’ç»™èšåˆå‘½ä»¤çš„å…¶ä»–é€‰é¡¹ã€‚2.6ç‰ˆä¸­çš„æ–°å¢åŠŸèƒ½ï¼šä»…å½“å°†ç®¡é“æŒ‡å®šä¸ºæ•°ç»„æ—¶æ‰å¯ç”¨     $matchå’Œ$group  ç›¸å½“äºsqlä¸­çš„whereå’Œgroup by\n{\"$match\": {â€œå­—æ®µâ€: â€œæ¡ä»¶â€}}ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•å¸¸ç”¨æŸ¥è¯¢æ“ä½œç¬¦$gtï¼Œ$ltï¼Œ$inç­‰\n{\"$group\"ï¼š{\"_id\": åˆ†ç»„å­—æ®µ, â€œæ–°çš„å­—æ®µåâ€: â€œèšåˆæ“ä½œç¬¦â€}}\n å°†åˆ†ç»„å­—æ®µä¼ ç»™$groupå‡½æ•°çš„_idå­—æ®µå³å¯ åˆ†ç»„åèšåˆå¾—åˆ°ç»“æœï¼Œç±»ä¼¼äºsqlä¸­èšåˆå‡½æ•°çš„èšåˆæ“ä½œç¬¦ï¼š$sumã€$avgã€$maxã€$minã€$firstã€$last   #{\"$match\":{\"å­—æ®µ\":\"æ¡ä»¶\"}}ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•å¸¸ç”¨æŸ¥è¯¢æ“ä½œç¬¦$gt,$lt,$inç­‰#select_idjob,avg(sal)avg_salaryfromdb.empwheredepno=30groupbyjob;db.emp.aggregate([{\"$match\":{\"depno\":{\"$eq\":30}}},{\"$group\":{\"_id\":\"$job\",\"avg_salary\":{\"$avg\":\"$sal\"}}}])#select_idjob,avg(sal)avg_salaryfromdb.empwheredepno=30groupbyjobhavingavg_salary2000;db.emp.aggregate([{\"$match\":{\"depno\":{\"$eq\":30}}},{\"$group\":{\"_id\":\"$job\",\"avg_salary\":{\"$avg\":\"$sal\"}}},{\"$match\":{\"avg_salary\":{\"$gt\":2000}}}])$project  ç”¨äºæŠ•å°„ï¼Œå³è®¾å®šè¯¥é”®å€¼å¯¹æ˜¯å¦ä¿ç•™ã€‚1ä¸ºä¿ç•™ï¼Œ0ä¸ºä¸ä¿ç•™ï¼Œå¯å¯¹åŸæœ‰é”®å€¼å¯¹åšæ“ä½œåå¢åŠ è‡ªå®šä¹‰è¡¨è¾¾å¼(æŸ¥è¯¢å“ªäº›è¦æ˜¾ç¤ºçš„åˆ—)\n {\"$project\":{\"è¦ä¿ç•™çš„å­—æ®µå\":1,\"è¦å»æ‰çš„å­—æ®µå\":1,\"æ–°å¢çš„å­—æ®µå\":\"è¡¨è¾¾å¼\"}}db.emp.aggregate()#selectename,job,(sal+400)asnew_salfromdb.emp;db.emp.aggregate([{$project:{\"ename\":1,\"job\":1,\"new_sal\":{\"$add\":[\"$sal\",400]}}}])$sortå’Œ$limitå’Œ$skip  æ’åºï¼š{\"$sort\": {â€œå­—æ®µåâ€: 1, â€œå­—æ®µåâ€: -1}} #1å‡åºï¼Œ-1é™åº\né™åˆ¶ï¼š{\"$limit\": n}\nè·³è¿‡ï¼š{\"$skip\": n} #è·³è¿‡å¤šå°‘ä¸ªæ–‡æ¡£\n #ä¾‹1ã€å–å¹³å‡å·¥èµ„æœ€é«˜çš„å‰ä¸¤ä¸ªå·¥ä½œdb.emp.aggregate([{\"$group\":{\"_id\":\"$job\",\"avg_sal\":{\"$avg\":\"$sal\"}}},{\"$sort\":{\"avg_sal\":-1}},{\"$limit\":2}])#ä¾‹2ã€å–å¹³å‡å·¥èµ„æœ€é«˜çš„ç¬¬äºŒä¸ªéƒ¨é—¨db.emp.aggregate([{\"$group\":{\"_id\":\"$job\",\"avg_sal\":{\"$avg\":\"$sal\"}}},{\"$sort\":{\"avg_sal\":-1}},{\"$skip\":1},{\"$limit\":1}])$sample  éšæœºé€‰å–nä¸ªï¼š$sample\n db.emp.aggregate([{\"$sample\":{size:3}}])ä¿®æ”¹æ–‡æ¡£ /* ä¿®æ”¹ db.collection.update(æŸ¥è¯¢æ¡ä»¶ï¼Œæ–°å¯¹è±¡) - update()é»˜è®¤æƒ…å†µä¸‹ä¼šä½¿ç”¨æ–°å¯¹è±¡æ¥æ›¿æ¢æ—§å¯¹è±¡(æ—§ç‰ˆæœ¬) - update()æ—§ç‰ˆæœ¬æ–°å¯¹è±¡ä¸å†™å…¨æˆ–æ˜¯ä¸ç”¨$setï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šæŠ¥é”™ (Invalid key 'age': update only works with $ operators and pipelines) - å¦‚æœéœ€è¦ä¿®æ”¹æŒ‡å®šçš„å±æ€§ï¼Œè€Œä¸æ˜¯æ›¿æ¢éœ€è¦ä½¿ç”¨\"ä¿®æ”¹æ“ä½œç¬¦\"æ¥å®Œæˆä¿®æ”¹ $set å¯ä»¥ç”¨æ¥ä¿®æ”¹æ–‡æ¡£ä¸­çš„æŒ‡å®šå±æ€§ $unset å¯ä»¥ç”¨æ¥åˆ é™¤æ–‡æ¡£ä¸­çš„æŒ‡å®šå±æ€§ - update()é»˜è®¤åªä¿®æ”¹ä¸€ä¸ª db.collection.updateMany() - åŒæ—¶ä¿®æ”¹å¤šä¸ªç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£ db.collection.updateOne() - ä¿®æ”¹ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£ */db.stus.find()//æ›¿æ¢db.stus.update({name:\"shasen\"},{age:28})db.stus.update({name:\"shasen\"},{$set:{age:28}})db.stus.update({_id:ObjectId(\"60da92e09e15000095005504\")},{$set:{name:\"shaheshang\"}})db.stus.find({_id:ObjectId(\"60da92e09e15000095005504\")})db.stus.update({_id:ObjectId(\"60da92e09e15000095005504\")},{$set:{gender:\"ç”·\",address:\"æµæ²™æ²³\"}})db.stus.update({_id:ObjectId(\"60da92e09e15000095005504\")},{$unset:{address:1}})db.stus.updateMany({name:\"zhubajie\"},{$set:{address:\"zhulaozhuang\"}})db.stus.update({name:\"zhubajie\"},{$set:{address:\"zhulaozhuang\"}})db.stus.update({name:\"zhubajie\"},{$set:{address:\"hehehe\"}},{multi:true})db.stus.find()åˆ é™¤æ–‡æ¡£ /* åˆ é™¤ db.collection.remove() -- åˆ é™¤ç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰æ–‡æ¡£(é»˜è®¤æƒ…å†µä¸‹ä¼šåˆ é™¤å¤šä¸ª) å¦‚æœremove()ç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ä¸€ä¸ªtrueï¼Œåˆ™åªä¼šåˆ é™¤ä¸€ä¸ª -- å¦‚æœå€¼ä¼ é€’ä¸€ä¸ªç©ºå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œåˆ™ä¼šåˆ é™¤ç»“åˆä¸­çš„æ‰€æœ‰æ–‡æ¡£\tdb.collection.deleteOne() db.collection.deleteMany() -- remove()å¯ä»¥æ ¹æ®æ¡ä»¶æ¥åˆ é™¤æ–‡æ¡£ï¼Œä¼ é€’çš„æ¡ä»¶æ–¹å¼å’Œfind()ä¸€æ · db.collection.drop(); -- åˆ é™¤é›†åˆ db.dropDatabase() åˆ é™¤æ•°æ®åº“ -- æ•°æ®åº“ä¸­çš„æ•°æ®éƒ½å¹¶ä¸ä¼šåˆ é™¤ï¼Œæ‰€ä»¥åˆ é™¤çš„æ–¹æ³•å¾ˆå°‘è°ƒç”¨ ä¸€èˆ¬ä¼šåœ¨æ•°æ®ä¸­æ·»åŠ ä¸€ä¸ªå­—æ®µï¼Œæ¥è¡¨ç¤ºæ•°æ®æ˜¯å¦è¢«åˆ é™¤ */db.stus.remove({_id:\"hello\"})db.stus.find()db.stus.insert([{age:28},{age:28}])db.stus.remove({age:28},true)//æ¸…ç©ºé›†åˆ(æ€§èƒ½ç•¥å·®)db.stus.remove({})showcollections;db.stus.drop()showdbs;db.dropDatabase();æ–‡æ¡£å…³ç³» /* æ–‡æ¡£ä¹‹é—´çš„å…³ç³» ä¸€å¯¹ä¸€(one to one) -- å¤«å¦»(ä¸€ä¸ªä¸ˆå¤« å¯¹åº” ä¸€ä¸ªå¦»å­) -- åœ¨MongoDBï¼Œå¯ä»¥é€šè¿‡å†…åµŒæ–‡æ¡£çš„å½¢å¼æ¥ä½“ç°å‡ºä¸€å¯¹ä¸€çš„å…³ç³» ä¸€å¯¹å¤š(one to many) / å¤šå¯¹ä¸€(many to one) -- çˆ¶æ¯ - å­©å­ ç”¨æˆ· - è®¢å• æ–‡ç«  - è¯„è®º - ä¹Ÿå¯ä»¥é€šè¿‡å†…åµŒæ–‡æ¡£æ¥æ˜ å°„ä¸€å¯¹å¤šçš„å…³ç³» å¤šå¯¹å¤š(many to many) -- åˆ†ç±» - å•†å“ è€å¸ˆ - å­¦ç”Ÿ */ db.wifeAndHusband.insert([ { name: \"é»„è“‰\", husband: { name: \"éƒ­é–\" } },{ name: \"æ½˜é‡‘è²\", husband: { name: \"æ­¦å¤§éƒ\" } } ]); db.wifeAndHusband.find() // ä¸€å¯¹å¤š ç”¨æˆ·(users) å’Œ è®¢å•() db.users.insert([ { username: \"swk\" },{ username: \"zbj\" } ]) db.users.find() db.order.insert({ list: [\"ç‰›è‚‰\", \"æ¼«ç”»\"], user_id: ObjectId(\"60dbc477c673000085000595\") }) db.order.find() // æŸ¥æ‰¾ç”¨æˆ·swkçš„è®¢å• var user_id = db.users.findOne({username: \"zbj\"})._id db.order.find({user_id: user_id}) // å¤šå¯¹å¤š db.teachers.insert([ {name: \"æ´ªä¸ƒå…¬\"}, {name: \"é»„è¯å¸ˆ\"}, {name: \"é¾Ÿä»™äºº\"} ]) db.stus.insert([{ name: \"éƒ­é–\", tech_ids: [ ObjectId(\"60dbc694c67300008500059a\"), ObjectId(\"60dbc694c67300008500059b\") ] },{ name: \"å­™æ‚Ÿç©º\", tech_ids: [ ObjectId(\"60dbc694c67300008500059a\"), ObjectId(\"60dbc694c67300008500059b\"), ObjectId(\"60dbc694c67300008500059c\") ] } ]) db.teachers.find() db.stus.find() Test //17.å‘numbersä¸­æ’å…¥20000æ¡æ•°æ® var arr = []; for(var i = 1; i  20000; i++){ arr.push({num: i}); } db.numbers.insert(arr) //18.æŸ¥è¯¢numbersä¸­numä¸º500çš„æ–‡æ¡£ db.numbers.find({num: 500}) //19.æŸ¥è¯¢numbersä¸­numå¤§äº5000çš„æ–‡æ¡£ db.numbers.find({num: {$gt: 5000}}) //20.æŸ¥è¯¢numbersä¸­numå°äº30çš„æ–‡æ¡£ db.numbers.find({num: {$lt: 30}}) //21.æŸ¥è¯¢numbersä¸­numå¤§äº40å°äº50çš„æ–‡æ¡£ db.numbers.find({num: {$gt: 40, $lt: 50}}) //22.æŸ¥è¯¢numbersä¸­numå¤§äº19996çš„æ–‡æ¡£ db.numbers.find({num: {$gt: 19996}}) //23.æŸ¥çœ‹numbersé›†åˆä¸­çš„å‰10æ¡æ•°æ® //limit()è®¾ç½®æ˜¾ç¤ºæ•°æ®çš„ä¸Šé™ db.numbers.find({}).limit(10) //åœ¨å¼€å‘æ—¶ï¼Œæˆ‘ä»¬ç»å¯¹ä¸ä¼šæ‰§è¡Œä¸å¸¦æ¡ä»¶çš„æŸ¥è¯¢ db.numbers.find({}) //24.æŸ¥çœ‹numbersé›†åˆä¸­çš„ç¬¬11æ¡åˆ°20æ¡æ•°æ® //skip()ç”¨äºè·³è¿‡æŒ‡å®šæ•°é‡çš„æ•°æ® db.numbers.find({}).limit(10).skip(10) //25.æŸ¥çœ‹numbersé›†åˆä¸­çš„ç¬¬21æ¡åˆ°30æ¡æ•°æ® db.numbers.find({}).limit(10).skip(20) //26.å°†deptå’Œempé›†åˆå¯¼å…¥åˆ°æ•°æ®åº“ä¸­  //27.æŸ¥è¯¢å·¥èµ„å°äº2000çš„å‘˜å·¥ db.emp.find({sal: {$lt: 2000}}) //28.æŸ¥è¯¢å·¥èµ„åœ¨1000-2000ä¹‹é—´çš„å‘˜å·¥ db.emp.find({sal: {$gt: 1000, $lt: 2000}}) //29.æŸ¥è¯¢å·¥èµ„å°äº1000æˆ–å¤§äº2500çš„å‘˜å·¥ db.emp.find({ $or: [ {sal: {$lt: 1000}}, {sal: {$gt: 2500}} ] }); //30.æŸ¥è¯¢è´¢åŠ¡éƒ¨çš„æ‰€æœ‰å‘˜å·¥ var deptno = db.dep.findOne({dname: \"è´¢åŠ¡éƒ¨\"}).deptno db.emp.find({depno: deptno}) //31.æŸ¥è¯¢é”€å”®éƒ¨çš„æ‰€æœ‰å‘˜å·¥ var deptno = db.dep.findOne({dname: \"é”€å”®éƒ¨\"}).deptno db.emp.find({depno: deptno}) //32.æŸ¥è¯¢æ‰€æœ‰mgrä¸º7698çš„æ‰€æœ‰å‘˜å·¥ db.emp.find({mgr: 7698}) //33.ä¸ºæ‰€æœ‰è–ªèµ„ä½äº1000çš„å‘˜å·¥å¢åŠ å·¥èµ„400å…ƒ db.emp.updateMany({sal: {$lte: 1000}}, { $inc: { sal: 400 } } ) db.emp.find() emp:\n{ \"_id\" : ObjectId(\"5941f5bfc1bc86928f4de4ac\"), \"empno\" : 7369.0, \"ename\" : \"æ—å†²\", \"job\" : \"èŒå‘˜\", \"mgr\" : 7902.0, \"hiredate\" : ISODate(\"1980-12-16T16:00:00Z\"), \"sal\" : 800.0, \"depno\" : 20.0 } { \"_id\" : ObjectId(\"5941f5bfc1bc86928f4de4ad\"), \"empno\" : 7499.0, \"ename\" : \"å­™äºŒå¨˜\", \"job\" : \"é”€å”®\", \"mgr\" : 7698.0, \"hiredate\" : ISODate(\"1981-02-19T16:00:00Z\"), \"sal\" : 1600.0, \"comm\" : 300.0, \"depno\" : 30.0 } { \"_id\" : ObjectId(\"5941f5bfc1bc86928f4de4ae\"), \"empno\" : 7521.0, \"ename\" : \"æ‰ˆä¸‰å¨˜\", \"job\" : \"é”€å”®\", \"mgr\" : 7698.0, \"hiredate\" : ISODate(\"1981-02-21T16:00:00Z\"), \"sal\" : 1250.0, \"comm\" : 500.0, \"depno\" : 30.0 } { \"_id\" : ObjectId(\"5941f5bfc1bc86928f4de4af\"), \"empno\" : 7566.0, \"ename\" : \"å¢ä¿Šä¹‰\", \"job\" : \"ç»ç†\", \"mgr\" : 7839.0, \"hiredate\" : ISODate(\"1981-04-01T16:00:00Z\"), \"sal\" : 2975.0, \"depno\" : 20.0 } { \"_id\" : ObjectId(\"5941f5bfc1bc86928f4de4b0\"), \"empno\" : 7654.0, \"ename\" : \"æ½˜é‡‘è²\", \"job\" : \"é”€å”®\", \"mgr\" : 7698.0, \"hiredate\" : ISODate(\"1981-09-27T16:00:00Z\"), \"sal\" : 1250.0, \"comm\" : 1400.0, \"depno\" : 30.0 } { \"_id\" : ObjectId(\"5941f5bfc1bc86928f4de4b1\"), \"empno\" : 7698.0, \"ename\" : \"è¥¿é—¨åº†\", \"job\" : \"ç»ç†\", \"mgr\" : 7839.0, \"hiredate\" : ISODate(\"1981-04-30T16:00:00Z\"), \"sal\" : 2850.0, \"depno\" : 30.0 } { \"_id\" : ObjectId(\"5941f5bfc1bc86928f4de4b2\"), \"empno\" : 7782.0, \"ename\" : \"æŸ´è¿›\", \"job\" : \"ç»ç†\", \"mgr\" : 7839.0, \"hiredate\" : ISODate(\"1981-06-08T16:00:00Z\"), \"sal\" : 2450.0, \"depno\" : 10.0 } { \"_id\" : ObjectId(\"5941f5bfc1bc86928f4de4b3\"), \"empno\" : 7788.0, \"ename\" : \"å…¬å­™èƒœ\", \"job\" : \"åˆ†æå¸ˆ\", \"mgr\" : 7566.0, \"hiredate\" : ISODate(\"1987-07-12T16:00:00Z\"), \"sal\" : 3000.0, \"depno\" : 20.0 } { \"_id\" : ObjectId(\"5941f5bfc1bc86928f4de4b4\"), \"empno\" : 7839.0, \"ename\" : \"å®‹æ±Ÿ\", \"job\" : \"è‘£äº‹é•¿\", \"hiredate\" : ISODate(\"1981-11-16T16:00:00Z\"), \"sal\" : 5000.0, \"depno\" : 10.0 } { \"_id\" : ObjectId(\"5941f5bfc1bc86928f4de4b5\"), \"empno\" : 7844.0, \"ename\" : \"é˜å©†æƒœ\", \"job\" : \"é”€å”®\", \"mgr\" : 7698.0, \"hiredate\" : ISODate(\"1981-09-07T16:00:00Z\"), \"sal\" : 1500.0, \"comm\" : 0.0, \"depno\" : 30.0 } { \"_id\" : ObjectId(\"5941f5bfc1bc86928f4de4b6\"), \"empno\" : 7876.0, \"ename\" : \"æé€µ\", \"job\" : \"èŒå‘˜\", \"mgr\" : 7902.0, \"hiredate\" : ISODate(\"1987-07-12T16:00:00Z\"), \"sal\" : 1100.0, \"depno\" : 20.0 } { \"_id\" : ObjectId(\"5941f5bfc1bc86928f4de4b7\"), \"empno\" : 7900.0, \"ename\" : \"æ­¦æ¾\", \"job\" : \"èŒå‘˜\", \"mgr\" : 7782.0, \"hiredate\" : ISODate(\"1981-12-02T16:00:00Z\"), \"sal\" : 950.0, \"depno\" : 10.0 } { \"_id\" : ObjectId(\"5941f5bfc1bc86928f4de4b8\"), \"empno\" : 7902.0, \"ename\" : \"å´ç”¨\", \"job\" : \"åˆ†æå¸ˆ\", \"mgr\" : 7566.0, \"hiredate\" : ISODate(\"1981-12-02T16:00:00Z\"), \"sal\" : 3000.0, \"depno\" : 20.0 } { \"_id\" : ObjectId(\"5941f5bfc1bc86928f4de4b9\"), \"empno\" : 7934.0, \"ename\" : \"é²æ™ºæ·±\", \"job\" : \"èŒå‘˜\", \"mgr\" : 7782.0, \"hiredate\" : ISODate(\"1982-01-22T16:00:00Z\"), \"sal\" : 1300.0, \"depno\" : 10.0 } dept\n{ \"_id\" : ObjectId(\"5941f2bac1bc86928f4de49a\"), \"deptno\" : 10.0, \"dname\" : \"è´¢åŠ¡éƒ¨\", \"loc\" : \"åŒ—äº¬\" } { \"_id\" : ObjectId(\"5941f2bac1bc86928f4de49b\"), \"deptno\" : 20.0, \"dname\" : \"åŠå…¬å®¤\", \"loc\" : \"ä¸Šæµ·\" } { \"_id\" : ObjectId(\"5941f2bac1bc86928f4de49c\"), \"deptno\" : 30.0, \"dname\" : \"é”€å”®éƒ¨\", \"loc\" : \"å¹¿å·\" } { \"_id\" : ObjectId(\"5941f2bac1bc86928f4de49d\"), \"deptno\" : 40.0, \"dname\" : \"è¿è¥éƒ¨\", \"loc\" : \"æ·±åœ³\" } æ’åºå’ŒæŠ•å½± // æŸ¥è¯¢æ–‡æ¡£æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯æŒ‰ç…§_idçš„å€¼è¿›è¡Œæ’åˆ—(å‡åº) //sort()å¯ä»¥ç”¨æ¥æŒ‡å®šæ–‡æ¡£çš„æ’åºçš„è§„åˆ™ï¼Œsort()éœ€è¦ä¼ é€’ä¸€ä¸ªå¯¹è±¡æ¥æŒ‡å®šæ’åºè§„åˆ™ 1è¡¨ç¤ºå‡åº -1è¡¨ç¤ºé™åº //limit skip sort å¯ä»¥ä»»æ„çš„é¡ºåºè¿›è¡Œè°ƒç”¨ db.emp.find({}).sort({sal: -1}) //åœ¨æŸ¥è¯¢æ—¶ï¼Œå¯ä»¥åœ¨ç¬¬äºŒä¸ªå‚æ•°çš„ä½ç½®æ¥è®¾ç½®æŸ¥è¯¢ç»“æœçš„ æŠ•å½± db.emp.find({}, {ename: 1, _id: 0, sal: 1}); nodeæ•´åˆmongodb- Mongoose http://mongoosejs.com/\nè¿æ¥æ•°æ®åº“ /* 1. ä¸‹è½½å®‰è£…Mongoose npm i mongoose --save 2. åœ¨é¡¹ç›®ä¸­å¼•å…¥mongoose var mongoose = require(\"mongoose\") 3. è¿æ¥MongoDBæ•°æ®åº“ mongoose.connect('mongodb://localhost:27017/test', {useMongoClient: true}); - å¦‚æœç«¯å£å·æ˜¯é»˜è®¤ç«¯å£å·(27017) åˆ™å¯ä»¥çœç•¥ä¸å†™ 4. æ–­å¼€æ•°æ®åº“è¿æ¥(ä¸€èˆ¬ä¸éœ€è¦è°ƒç”¨) - MongoDBæ•°æ®åº“ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåªéœ€è¦è¿æ¥ä¸€æ¬¡ï¼Œè¿æ¥ä¸€æ¬¡ä»¥åï¼Œé™¤éé¡¹ç›®åœæ­¢ï¼ŒæœåŠ¡å™¨å…³é—­ï¼Œå¦åˆ™è¿æ¥ä¸€èˆ¬ä¸ä¼šæ–­å¼€ mongoose.disconnect() - ç›‘å¬MongoDBæ•°æ®åº“çš„è¿æ¥çŠ¶æ€ - åœ¨Mongooseå¯¹è±¡ä¸­ï¼Œæœ‰ä¸€ä¸ªå±æ€§å«åšConnectionï¼Œè¯¥å¯¹è±¡è¡¨ç¤ºçš„å°±æ˜¯æ•°æ®åº“è¿æ¥ é€šè¿‡ç›‘è§†è¯¥å¯¹è±¡çš„çŠ¶æ€ï¼Œå¯ä»¥æ¥ç›‘å¬æ•°æ®åº“çš„è¿æ¥ä¸æ–­å¼€ æ•°æ®åº“è¿æ¥æˆåŠŸçš„äº‹ä»¶ mongoose.connection.once(\"open\", function()); æ•°æ®åº“æ–­å¼€çš„äº‹ä»¶ mongoose.connection.once(\"close\", function()); Schema Model Document */ // å¼•å…¥ var mongoose = require(\"mongoose\"); // è¿æ¥æ•°æ®åº“ // mongoose.connect(\"mongodb://127.0.0.1/mongoose_test\", { useNewUrlParser: true } ); mongoose.connect('mongodb://localhost:27017/test', { useNewUrlParser: true, useUnifiedTopology: true }); mongoose.connection.once(\"open\", () = { console.log(\"æ•°æ®åº“è¿æ¥æˆåŠŸ~~~~~\"); }); mongoose.connection.once(\"close\", () = { console.log(\"æ•°æ®åº“å·²ç»æ–­å¼€~~~~~\"); }); //æ–­å¼€æ•°æ®åº“è¿æ¥ mongoose.disconnect() ä½¿ç”¨ç¤ºä¾‹ var mongoose = require(\"mongoose\"); mongoose.connect(\"mongodb://localhost/mongoose_test\", { useNewUrlParser: true, useUnifiedTopology: true, }); // åˆ›å»ºSchema(æ¨¡å¼å¯¹è±¡) var { Schema } = mongoose var stuSchema = new Schema({ name: String, age: Number, gender: { type: String, default: \"female\" }, address: String }) // é€šè¿‡Schemaæ¥åˆ›å»ºModel // Modelä»£è¡¨çš„æ˜¯æ•°æ®åº“ä¸­çš„é›†åˆï¼Œé€šè¿‡Modelæ‰èƒ½å¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œ // mongoose.model(modelName, schema); // modelName å°±æ˜¯è¦æ˜ å°„çš„é›†åˆå mongooseä¼šè‡ªåŠ¨è½¬æ¢æˆå¤æ•° var StuModel = mongoose.model(\"student\", stuSchema) // å‘æ•°æ®åº“ä¸­æ’å…¥ä¸€ä¸ªæ–‡æ¡£ // StuModel.create(doc, function)); StuModel.create({ name: \"ç™½éª¨ç²¾\", age: 18, address: \"ç™½éª¨æ´\" }, (err) = { if (!err) { console.log(\"æ’å…¥æˆåŠŸ\"); } }); Modelä½¿ç”¨ var mongoose = require(\"mongoose\"); mongoose.connect(\"mongodb://localhost/mongoose_test\", { useNewUrlParser: true, useUnifiedTopology: true, }); // åˆ›å»ºSchema(æ¨¡å¼å¯¹è±¡) var { Schema } = mongoose var stuSchema = new Schema({ name: String, age: Number, gender: { type: String, default: \"female\" }, address: String }) // é€šè¿‡Schemaæ¥åˆ›å»ºModel // Modelä»£è¡¨çš„æ˜¯æ•°æ®åº“ä¸­çš„é›†åˆï¼Œé€šè¿‡Modelæ‰èƒ½å¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œ // mongoose.model(modelName, schema); // modelName å°±æ˜¯è¦æ˜ å°„çš„é›†åˆå mongooseä¼šè‡ªåŠ¨è½¬æ¢æˆå¤æ•° var StuModel = mongoose.model(\"student\", stuSchema) /* - æœ‰äº†Modelï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨æ¥å¯¹æ•°æ®åº“è¿›è¡Œå¢åˆ æ”¹æŸ¥çš„æ“ä½œäº† Model.create(doc(s), [callback]) - ç”¨æ¥åˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªæ–‡æ¡£å¹¶æ·»åŠ åˆ°æ•°æ®åº“ä¸­ - å‚æ•°ï¼š doc(s) å¯ä»¥æ˜¯ä¸€ä¸ªæ–‡æ¡£å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ–‡æ¡£å¯¹è±¡çš„æ•°ç»„ callback å½“æ“ä½œå®Œæˆä»¥åè°ƒç”¨çš„å›è°ƒå‡½æ•° æŸ¥è¯¢çš„: Model.find(conditions, [projection], [options], [callback]) - æŸ¥è¯¢æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£ Model.findById(id, [projection], [options], [callback]) - æ ¹æ®æ–‡æ¡£çš„idå±æ€§æŸ¥è¯¢æ–‡æ¡£ Model.findOne([conditions], [projection], [options], [callback]) - æŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„ç¬¬ä¸€ä¸ªæ–‡æ¡£ï¼Œæ€»ä¼šè¿”å›ä¸€ä¸ªå…·ä½“çš„æ–‡æ¡£ conditions æŸ¥è¯¢çš„æ¡ä»¶ projection æŠ•å½± éœ€è¦çš„å­—æ®µ - ä¸¤ç§æ–¹å¼ {name: 1, _id: 0} \"name -_id\" options æŸ¥è¯¢é€‰é¡¹(skip, limit) callback å›è°ƒå‡½æ•°ï¼ŒæŸ¥è¯¢ç»“æœä¼šé€šè¿‡å›è°ƒå‡½æ•°è¿”å› å›è°ƒå‡½æ•°å¿…é¡»ä¼ ï¼Œå¦‚æœä¸ä¼ å›è°ƒå‡½æ•°ï¼Œä¸ä¼šæŸ¥è¯¢ */ // StuModel.find({}, \"name age\", { // skip: 3, // limit: 1 // }, (err, docs) = { // if (!err) { // console.log(docs); // } // }) // StuModel.findOne({}, (err, docs) = { // if (!err) { // console.log(docs); // } // }) // StuModel.findById(\"60dbdbb2ecd64b4db4605b27\", (err, docs) = { // if (!err) { // // console.log(docs); // // é€šè¿‡find()æŸ¥è¯¢çš„ç»“æœï¼Œè¿”å›çš„å¯¹è±¡ï¼Œå°±æ˜¯Documentï¼Œæ–‡æ¡£å¯¹è±¡ // // Documentå¯¹è±¡æ˜¯Modelçš„å®ä¾‹ // console.log(docs instanceof StuModel); // } // })  // StuModel.create([{ // name: \"æ²™å’Œå°š\", // age: 28, // gender: \"male\", // address: \"æµæ²™æ²³\" // }], (error) = { // if (!error) { // console.log(arguments); // } // })  /* ä¿®æ”¹ Model.update(conditions, doc, [options], [callback]) Model.updateMany(conditions, doc, [options], [callback]) Model.updateOne(conditions, doc, [options], [callback]) Model.replaceOne(conditions, doc, [options], [callback]) - ç”¨æ¥ä¿®æ”¹ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡æ¡£ - å‚æ•°ï¼š conditions æŸ¥è¯¢æ¡ä»¶ doc ä¿®æ”¹åçš„å¯¹è±¡ options é…ç½®å‚æ•° callback å›è°ƒå‡½æ•° */ // ä¿®æ”¹å”åƒ§çš„å¹´é¾„ä¸º20 // StuModel.updateOne({ // name: \"å”åƒ§\" // }, { // $set: { // age: 20 // } // }, (err) = { // if (!err) { // console.log(\"ä¿®æ”¹æˆåŠŸ\"); // } // })  /* åˆ é™¤ Model.remove(conditions, [callback]) Model.deleteOne(conditions, [callback]) Model.deleteMany(conditions, [callback]) */ // StuModel.deleteOne({ // name: \"æ²™å’Œå°š\" // }, // err = { // if (!err) { // console.log(\"åˆ é™¤æˆåŠŸ\"); // } // })  /* Model.count(conditions, [callback]) - ç»Ÿè®¡æ–‡æ¡£çš„æ•°é‡çš„ */ StuModel.count({}, function (err, count) { if (!err) { console.log(count); } }); Documentä½¿ç”¨ /* Document å’Œ é›†åˆä¸­çš„æ–‡æ¡£ä¸€ä¸€å¯¹åº”ï¼ŒDocumentæ˜¯Modelå®ä¾‹ é€šè¿‡ModelæŸ¥è¯¢åˆ°ç»“æœéƒ½æ˜¯Document */ // åˆ›å»ºä¸€ä¸ªDocument var mongoose = require(\"mongoose\"); mongoose.connect(\"mongodb://localhost/mongoose_test\", { useNewUrlParser: true, useUnifiedTopology: true, }); // åˆ›å»ºSchema(æ¨¡å¼å¯¹è±¡) var { Schema } = mongoose var stuSchema = new Schema({ name: String, age: Number, gender: { type: String, default: \"female\" }, address: String }) // é€šè¿‡Schemaæ¥åˆ›å»ºModel // Modelä»£è¡¨çš„æ˜¯æ•°æ®åº“ä¸­çš„é›†åˆï¼Œé€šè¿‡Modelæ‰èƒ½å¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œ // mongoose.model(modelName, schema); // modelName å°±æ˜¯è¦æ˜ å°„çš„é›†åˆå mongooseä¼šè‡ªåŠ¨è½¬æ¢æˆå¤æ•° var StuModel = mongoose.model(\"student\", stuSchema) var stu = new StuModel({ name: \"å¥”æ³¢éœ¸\", age: 48, gender: \"male\", address: \"ç¢§æ³¢æ½­\" }); /* documentçš„æ–¹æ³• Model#save([options], [fn]) */ // stu.save(err = { // if (!err) { // console.log(\"ä¿å­˜æˆåŠŸ\"); // } // }) StuModel.findOne({}, (err, doc) = { if (!err) { /* update(update,[options],[callback]) -- ä¿®æ”¹å¯¹è±¡ remove([callback]) -- åˆ é™¤å¯¹è±¡ */ // console.log(doc);  // doc.update({  // $set: {  // age: 28  // }  // }, err = {  // if (!err) {  // console.log(\"ä¿®æ”¹æˆåŠŸ\");  // }  // })  // doc.remove(err = {  // if (!err) {  // console.log(\"å¤§å¸ˆå…„å†è§\");  // }  // })  /* get(name) -è·å–æ–‡æ¡£ä¸­çš„æŒ‡å®šå±æ€§å€¼ set() id - è·å–æ–‡æ¡£çš„_idå±æ€§å€¼ toJSON() - è½¬æ¢ä¸ºä¸€ä¸ªJSONå­—ç¬¦ä¸² toObject() - å°†Documentè½¬æ¢æˆæ™®é€šçš„JSONå¯¹è±¡ */ // console.log(doc.get(\"age\"));  // console.log(doc.age);  // doc.set(\"name\", \"çŒªğŸ–\")  // doc.name = \"å“ˆå“ˆå“ˆ\"  doc = doc.toObject(); delete doc.address; console.log(doc); } }) ",
  "wordCount" : "1637",
  "inLanguage": "en",
  "datePublished": "2021-07-09T00:00:00Z",
  "dateModified": "2021-07-09T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Rex"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://rex0520.github.io/posts/nosql/mongodb/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Rex",
    "logo": {
      "@type": "ImageObject",
      "url": "https://rex0520.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://rex0520.github.io/" accesskey="h" title="Home (Alt + H)">
                <img src="http://cdn.rexweb.xyz/img/20210821105340.png" alt="logo" aria-label="logo"
                    height="35">Home</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://rex0520.github.io/posts/" title="æ–‡ç« ">
                    <span>æ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://rex0520.github.io/categories/" title="åˆ†ç±»">
                    <span>åˆ†ç±»</span>
                </a>
            </li>
            <li>
                <a href="https://rex0520.github.io/tags/" title="æ ‡ç­¾">
                    <span>æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://rex0520.github.io/archives/" title="æ—¶é—´è½´">
                    <span>æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://rex0520.github.io/search/" title="æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>æœç´¢</span>
                </a>
            </li>
        </ul>
    </nav>
</header><main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://rex0520.github.io/">Home</a>&nbsp;Â»&nbsp;<a href="https://rex0520.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      MongodbåŸºç¡€
    </h1>
    <div class="post-description">
      MongodbåŸºç¡€
    </div>
    <div class="post-meta">2021-07-09&nbsp;Â·&nbsp;8 min&nbsp;Â·&nbsp;Rex&nbsp;|&nbsp;<a href="https://github.com/Rex0520/Rex0520.github.io" rel="noopener noreferrer" target="_blank">æ¥è¿™ä¿®æ”¹</a>
</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#mongodb" aria-label="MongoDB">MongoDB</a><ul>
                        
                <li>
                    <a href="#%e7%ae%80%e4%bb%8b" aria-label="ç®€ä»‹ï¼š">ç®€ä»‹ï¼š</a></li>
                <li>
                    <a href="#%e4%b8%89%e4%b8%aa%e6%a6%82%e5%bf%b5" aria-label="ä¸‰ä¸ªæ¦‚å¿µ">ä¸‰ä¸ªæ¦‚å¿µ</a></li>
                <li>
                    <a href="#%e5%9f%ba%e6%9c%ac%e6%8c%87%e4%bb%a4" aria-label="åŸºæœ¬æŒ‡ä»¤">åŸºæœ¬æŒ‡ä»¤</a></li>
                <li>
                    <a href="#%e6%8f%92%e5%85%a5%e6%96%87%e6%a1%a3" aria-label="æ’å…¥æ–‡æ¡£">æ’å…¥æ–‡æ¡£</a></li>
                <li>
                    <a href="#%e6%9f%a5%e8%af%a2%e6%96%87%e6%a1%a3" aria-label="æŸ¥è¯¢æ–‡æ¡£">æŸ¥è¯¢æ–‡æ¡£</a><ul>
                        
                <li>
                    <a href="#%e6%9f%a5%e8%af%a2%e9%80%89%e6%8b%a9%e5%99%a8" aria-label="æŸ¥è¯¢é€‰æ‹©å™¨">æŸ¥è¯¢é€‰æ‹©å™¨</a></li>
                <li>
                    <a href="#%e4%b8%80%e8%88%ac%e6%9f%a5%e8%af%a2" aria-label="ä¸€èˆ¬æŸ¥è¯¢">ä¸€èˆ¬æŸ¥è¯¢</a></li>
                <li>
                    <a href="#%e6%9f%a5%e8%af%a2%e5%85%b6%e4%bb%96%e6%9d%a1%e4%bb%b6" aria-label="æŸ¥è¯¢å…¶ä»–æ¡ä»¶">æŸ¥è¯¢å…¶ä»–æ¡ä»¶</a><ul>
                        
                <li>
                    <a href="#%e6%98%a0%e5%b0%84" aria-label="æ˜ å°„">æ˜ å°„</a></li>
                <li>
                    <a href="#%e6%95%b0%e7%bb%84%e5%ad%90%e5%85%83%e7%b4%a0%e9%80%89%e6%8b%a9" aria-label="æ•°ç»„å­å…ƒç´ é€‰æ‹©ï¼š">æ•°ç»„å­å…ƒç´ é€‰æ‹©ï¼š</a></li>
                <li>
                    <a href="#%e6%8e%92%e5%ba%8f" aria-label="æ’åº">æ’åº</a></li>
                <li>
                    <a href="#%e8%b7%b3%e8%bf%87%e5%92%8c%e9%99%90%e5%88%b6" aria-label="è·³è¿‡å’Œé™åˆ¶">è·³è¿‡å’Œé™åˆ¶</a></li>
                <li>
                    <a href="#%e6%9f%a5%e8%af%a2%e5%94%af%e4%b8%80%e5%80%bc" aria-label="æŸ¥è¯¢å”¯ä¸€å€¼">æŸ¥è¯¢å”¯ä¸€å€¼</a></li></ul>
                </li>
                <li>
                    <a href="#%e8%81%9a%e5%90%88%e6%9f%a5%e8%af%a2" aria-label="èšåˆæŸ¥è¯¢">èšåˆæŸ¥è¯¢</a><ul>
                        
                <li>
                    <a href="#aggregate%e8%af%ad%e6%b3%95" aria-label="Aggregateè¯­æ³•">Aggregateè¯­æ³•</a></li>
                <li>
                    <a href="#match%e5%92%8cgroup" aria-label="$matchå’Œ$group">$matchå’Œ$group</a></li>
                <li>
                    <a href="#project" aria-label="$project">$project</a></li>
                <li>
                    <a href="#sort%e5%92%8climit%e5%92%8cskip" aria-label="$sortå’Œ$limitå’Œ$skip">$sortå’Œ$limitå’Œ$skip</a></li>
                <li>
                    <a href="#sample" aria-label="$sample">$sample</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#%e4%bf%ae%e6%94%b9%e6%96%87%e6%a1%a3" aria-label="ä¿®æ”¹æ–‡æ¡£">ä¿®æ”¹æ–‡æ¡£</a></li>
                <li>
                    <a href="#%e5%88%a0%e9%99%a4%e6%96%87%e6%a1%a3" aria-label="åˆ é™¤æ–‡æ¡£">åˆ é™¤æ–‡æ¡£</a></li>
                <li>
                    <a href="#%e6%96%87%e6%a1%a3%e5%85%b3%e7%b3%bb" aria-label="æ–‡æ¡£å…³ç³»">æ–‡æ¡£å…³ç³»</a></li>
                <li>
                    <a href="#test" aria-label="Test">Test</a></li>
                <li>
                    <a href="#%e6%8e%92%e5%ba%8f%e5%92%8c%e6%8a%95%e5%bd%b1" aria-label="æ’åºå’ŒæŠ•å½±">æ’åºå’ŒæŠ•å½±</a></li>
                <li>
                    <a href="#node%e6%95%b4%e5%90%88mongodb--mongoose" aria-label="nodeæ•´åˆmongodb- Mongoose">nodeæ•´åˆmongodb- Mongoose</a><ul>
                        
                <li>
                    <a href="#%e8%bf%9e%e6%8e%a5%e6%95%b0%e6%8d%ae%e5%ba%93" aria-label="è¿æ¥æ•°æ®åº“">è¿æ¥æ•°æ®åº“</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e7%a4%ba%e4%be%8b" aria-label="ä½¿ç”¨ç¤ºä¾‹">ä½¿ç”¨ç¤ºä¾‹</a></li>
                <li>
                    <a href="#model%e4%bd%bf%e7%94%a8" aria-label="Modelä½¿ç”¨">Modelä½¿ç”¨</a></li>
                <li>
                    <a href="#document%e4%bd%bf%e7%94%a8" aria-label="Documentä½¿ç”¨">Documentä½¿ç”¨</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="mongodb">MongoDB<a hidden class="anchor" aria-hidden="true" href="#mongodb">#</a></h1>
<h2 id="ç®€ä»‹">ç®€ä»‹ï¼š<a hidden class="anchor" aria-hidden="true" href="#ç®€ä»‹">#</a></h2>
<blockquote>
<ul>
<li>MongoDBæ˜¯ä¸ºå¿«é€Ÿå¼€å‘äº’è”ç½‘Webåº”ç”¨è€Œè®¾è®¡çš„æ•°æ®åº“ç³»ç»Ÿã€‚</li>
<li>MongoDBçš„è®¾è®¸ç›®æ ‡æ˜¯æç®€ã€çµæ´»ã€ä½œä¸ºWebåº”ç”¨æ ˆçš„ä¸€éƒ¨åˆ†ã€‚</li>
<li>MongoDBçš„æ•°æ®æ¨¡å‹æ˜¯é¢å‘æ–‡æ¡£çš„,æ‰€è°“æ–‡æ¡£æ˜¯- - -ç§ç±»ä¼¼äºJSONçš„ç»“æ„,ç®€å•ç†è§£MongoDBè¿™ä¸ªæ•°æ®åº“ä¸­å­˜çš„æ˜¯å„ç§å„æ ·çš„JSONã€‚ ( BSON )</li>
</ul>
</blockquote>
<h2 id="ä¸‰ä¸ªæ¦‚å¿µ">ä¸‰ä¸ªæ¦‚å¿µ<a hidden class="anchor" aria-hidden="true" href="#ä¸‰ä¸ªæ¦‚å¿µ">#</a></h2>
<ul>
<li>
<p>æ•°æ®åº“( database )</p>
<blockquote>
<p>æ•°æ®åº“æ˜¯-ä¸ªä»“åº“,åœ¨ä»“åº“ä¸­å¯ä»¥å­˜æ”¾é›†åˆã€‚</p>
</blockquote>
</li>
<li>
<p>é›†åˆ( collection )</p>
<blockquote>
<p>é›†åˆç±»ä¼¼äºæ•°ç»„,åœ¨é›†åˆä¸­å¯ä»¥å­˜æ”¾æ–‡æ¡£ã€‚</p>
</blockquote>
</li>
<li>
<p>æ–‡æ¡£( dotument )</p>
<blockquote>
<p>æ–‡æ¡£æ•°æ®åº“ä¸­çš„æœ€å°å•ä½,æˆ‘ä»¬å­˜å‚¨å’Œæ“ä½œçš„
å†…å®¹éƒ½æ˜¯æ–‡æ¡£ã€‚</p>
</blockquote>
</li>
</ul>
<h2 id="åŸºæœ¬æŒ‡ä»¤">åŸºæœ¬æŒ‡ä»¤<a hidden class="anchor" aria-hidden="true" href="#åŸºæœ¬æŒ‡ä»¤">#</a></h2>
<ul>
<li>
<p>show dbs</p>
<blockquote>
<p>æ˜¾ç¤ºå½“å‰çš„æ‰€æœ‰æ•°æ®åº“</p>
</blockquote>
</li>
<li>
<p>use æ•°æ®åº“å</p>
<blockquote>
<p>è¿›å…¥æŒ‡å®šçš„æ•°æ®åº“ä¸­</p>
</blockquote>
</li>
<li>
<p>db</p>
<blockquote>
<p>æ˜¾ç¤ºå½“å‰æ‰€å¤„çš„æ•°æ®åº“</p>
</blockquote>
</li>
<li>
<p>show collections</p>
<blockquote>
<p>æ˜¾ç¤ºæ•°æ®åº“ä¸­æ‰€æœ‰çš„é›†åˆ</p>
</blockquote>
</li>
<li>
<p>db.<code>&lt;collection&gt;</code>.insert(doc)</p>
<blockquote>
<p>å‘é›†åˆä¸­æ’å…¥ä¸€ä¸ªæ–‡æ¡£</p>
</blockquote>
</li>
<li>
<p>db.<code>&lt;collections&gt;</code>.find()</p>
<blockquote>
<p>æŸ¥çœ‹æ•°æ®åº“å­—æ®µ</p>
</blockquote>
</li>
</ul>
<h2 id="æ’å…¥æ–‡æ¡£">æ’å…¥æ–‡æ¡£<a hidden class="anchor" aria-hidden="true" href="#æ’å…¥æ–‡æ¡£">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="cm">/*
</span><span class="cm">	å‘æ•°æ®åº“æ’å…¥æ–‡æ¡£		
</span><span class="cm">	  db.&lt;collection&gt;.insert(
</span><span class="cm">	  	&lt;document or array of documents&gt;ï¼Œ
</span><span class="cm">	  	{
</span><span class="cm">	  		wirteConcern: &lt;document&gt;,
</span><span class="cm">            ordered: &lt;boolean&gt;
</span><span class="cm">	  	}
</span><span class="cm">	  )
</span><span class="cm">	  documents: å¿…å¡«ï¼Œè¡¨ç¤ºéœ€è¦æ’å…¥çš„æ–‡æ¡£ï¼Œå¯ä»¥æ˜¯å¤šä¸ªæ–‡æ¡£
</span><span class="cm">	  writeConcernï¼šå¯é€‰é¡¹ï¼Œå†™ç­–ç•¥
</span><span class="cm">	  orderedï¼šå¯é€‰ï¼Œè¡¨ç¤ºå¤šä¸ªæ–‡æ¡£æ˜¯å¦æŒ‰ç…§æ–‡æ¡£é¡ºåºå†™å…¥
</span><span class="cm">			-- å‘é›†åˆä¸­æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡æ¡£
</span><span class="cm">			-- å½“æˆ‘ä»¬å‘é›†åˆä¸­æ’å…¥æ–‡æ¡£æ—¶ï¼Œå¦‚æœæ²¡æœ‰ç»™æ–‡æ¡£æŒ‡å®š_idå±æ€§ï¼Œåˆ™æ•°æ®åº“ä¼šè‡ªåŠ¨ä¸ºæ–‡æ¡£æ·»åŠ _idï¼Œ
</span><span class="cm">					è¯¥å±æ€§ç”¨æ¥ä½œä¸ºæ–‡æ¡£çš„å”¯ä¸€æ ‡è¯†
</span><span class="cm">			-- _idå¯ä»¥è‡ªå·±æŒ‡å®šï¼Œå¦‚æœæŒ‡å®šäº†æ•°æ®åº“å°±ä¸ä¼šå†æ·»åŠ äº†ï¼Œå¦‚æœè‡ªå·±æŒ‡å®š_idï¼Œä¹Ÿå¿…é¡»ç¡®ä¿ä»–çš„å”¯ä¸€æ€§
</span><span class="cm">			
</span><span class="cm">		db.collection.insertOne()
</span><span class="cm">			-- æ’å…¥ä¸€ä¸ªæ–‡æ¡£å¯¹è±¡
</span><span class="cm">		db.collection.insertMany()
</span><span class="cm">			-- æ’å…¥å¤šä¸ªæ–‡æ¡£å¯¹è±¡
</span><span class="cm">*/</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="k">insert</span><span class="p">(</span><span class="err">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;zhubajie&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span><span class="w"> </span><span class="n">gender</span><span class="p">:</span><span class="s2">&#34;ç”·&#34;</span><span class="err">}</span><span class="p">)</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="k">insert</span><span class="p">([</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;shasen&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="mi">38</span><span class="p">,</span><span class="w"> </span><span class="n">gender</span><span class="p">:</span><span class="s2">&#34;ç”·&#34;</span><span class="err">}</span><span class="p">,</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;baigujing&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="n">gender</span><span class="p">:</span><span class="s2">&#34;å¥³&#34;</span><span class="err">}</span><span class="p">,</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;zhizhujing&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">,</span><span class="w"> </span><span class="n">gender</span><span class="p">:</span><span class="s2">&#34;å¥³&#34;</span><span class="err">}</span><span class="w">
</span><span class="w"></span><span class="p">])</span><span class="w">
</span></code></pre></div><h2 id="æŸ¥è¯¢æ–‡æ¡£">æŸ¥è¯¢æ–‡æ¡£<a hidden class="anchor" aria-hidden="true" href="#æŸ¥è¯¢æ–‡æ¡£">#</a></h2>
<h3 id="æŸ¥è¯¢é€‰æ‹©å™¨">æŸ¥è¯¢é€‰æ‹©å™¨<a hidden class="anchor" aria-hidden="true" href="#æŸ¥è¯¢é€‰æ‹©å™¨">#</a></h3>
<table>
<thead>
<tr>
<th>è¿ç®—ç¬¦ç±»å‹</th>
<th>è¿ç®—ç¬¦</th>
<th>è¿ç®—ç¬¦å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>$eq</td>
<td>ç­‰äº</td>
</tr>
<tr>
<td></td>
<td>$lt</td>
<td>å°äº</td>
</tr>
<tr>
<td>æ¯”</td>
<td>$lte</td>
<td>å°äºç­‰äº</td>
</tr>
<tr>
<td></td>
<td>$gt</td>
<td>å¤§äº</td>
</tr>
<tr>
<td></td>
<td>$gte</td>
<td>å¤§äºç­‰äº</td>
</tr>
<tr>
<td>è¾ƒ</td>
<td>$in</td>
<td>åˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨æŒ‡å®šçš„é›†åˆèŒƒå›´é‡Œ</td>
</tr>
<tr>
<td></td>
<td>$all</td>
<td>åˆ¤æ–­å…ƒç´ æ˜¯å¦ä¸åœ¨æŒ‡å®šçš„é›†åˆèŒƒå›´é‡Œ</td>
</tr>
<tr>
<td></td>
<td>$nin</td>
<td>åˆ¤æ–­å…ƒç´ æ˜¯å¦ä¸åœ¨æŒ‡å®šçš„èŒƒå›´é‡Œ</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>$ne</td>
<td>ä¸ç­‰äº</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>$not</td>
<td>ä¸åŒ¹é…ç»“æœ</td>
</tr>
<tr>
<td>é€»è¾‘</td>
<td>$or</td>
<td>æœ‰ä¸€ä¸ªæ¡ä»¶æˆç«‹åˆ™åŒ¹é…</td>
</tr>
<tr>
<td></td>
<td>$nor</td>
<td>æ‰€æœ‰æ¡ä»¶éƒ½å¿…é¡»åŒ¹é…</td>
</tr>
<tr>
<td>è¿ç®—</td>
<td>$and</td>
<td>æ‰€æœ‰æ¡ä»¶éƒ½å¿…é¡»åŒ¹é…</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>$exists</td>
<td>åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨</td>
</tr>
<tr>
<td>å…¶</td>
<td>.</td>
<td>å­æ–‡æ¡£åŒ¹é…</td>
</tr>
<tr>
<td>ä»–</td>
<td>$regex</td>
<td>æ­£åˆ™è¡¨è¾¾å¼</td>
</tr>
</tbody>
</table>
<h3 id="ä¸€èˆ¬æŸ¥è¯¢">ä¸€èˆ¬æŸ¥è¯¢<a hidden class="anchor" aria-hidden="true" href="#ä¸€èˆ¬æŸ¥è¯¢">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="cm">/*
</span><span class="cm">	æŸ¥è¯¢
</span><span class="cm">			db.collection.find()
</span><span class="cm">				-- find()ç”¨æ¥æŸ¥è¯¢æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£
</span><span class="cm">				-- find()å¯ä»¥æ¥å—ä¸€ä¸ªå¯¹è±¡ä½œä¸ºæ¡ä»¶å‚æ•°
</span><span class="cm">					{} è¡¨ç¤ºæŸ¥è¯¢é›†åˆä¸­æ‰€æœ‰çš„æ–‡æ¡£
</span><span class="cm">					{å±æ€§ï¼šå€¼} æŸ¥è¯¢å±æ€§æ˜¯æŒ‡å®šçš„æ–‡æ¡£
</span><span class="cm">				-- find() è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„
</span><span class="cm">			db.collection.findOne()
</span><span class="cm">				-- ç”¨æ¥æŸ¥è¯¢é›†åˆä¸­ç¬¦åˆæ¡ä»¶çš„ç¬¬ä¸€ä¸ªæ–‡æ¡£
</span><span class="cm">				-- findOne() è¿”å›çš„æ˜¯ä¸€ä¸ªæ–‡æ¡£å¯¹è±¡
</span><span class="cm">			db.collection.find({}).count()
</span><span class="cm">				-- æŸ¥è¯¢æ‰€æœ‰ç»“æœçš„æ•°é‡
</span><span class="cm">*/</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="k">insert</span><span class="p">(</span><span class="err">{</span><span class="n">_id</span><span class="p">:</span><span class="s2">&#34;hello&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="s2">&#34;zhubajie&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">:</span><span class="mi">28</span><span class="p">,</span><span class="w"> </span><span class="n">gender</span><span class="p">:</span><span class="s2">&#34;ç”·&#34;</span><span class="err">}</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="err">{</span><span class="n">age</span><span class="p">:</span><span class="mi">28</span><span class="err">}</span><span class="p">)</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="n">findOne</span><span class="p">(</span><span class="err">{</span><span class="n">age</span><span class="p">:</span><span class="mi">28</span><span class="err">}</span><span class="p">).</span><span class="n">name</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="err">{}</span><span class="p">).</span><span class="k">count</span><span class="p">()</span><span class="w">
</span></code></pre></div><h3 id="æŸ¥è¯¢å…¶ä»–æ¡ä»¶">æŸ¥è¯¢å…¶ä»–æ¡ä»¶<a hidden class="anchor" aria-hidden="true" href="#æŸ¥è¯¢å…¶ä»–æ¡ä»¶">#</a></h3>
<h4 id="æ˜ å°„">æ˜ å°„<a hidden class="anchor" aria-hidden="true" href="#æ˜ å°„">#</a></h4>
<ul>
<li>å­—æ®µé€‰æ‹©ï¼šdb.inventory.find({}, {&lsquo;item&rsquo;: 1})</li>
<li>å­—æ®µæ’é™¤ï¼šdb.inventory.find({}, {&lsquo;item&rsquo;: 0})</li>
</ul>
<h4 id="æ•°ç»„å­å…ƒç´ é€‰æ‹©">æ•°ç»„å­å…ƒç´ é€‰æ‹©ï¼š<a hidden class="anchor" aria-hidden="true" href="#æ•°ç»„å­å…ƒç´ é€‰æ‹©">#</a></h4>
<ul>
<li>db.inventory.find({}, {&lsquo;favorites.movies&rsquo;: {'$slice': [1, 2]}, &lsquo;favorites.cites&rsquo;: 1}), $sliceå¯ä»¥å–ä¿©ä¸ªå…ƒç´ æ•°ç»„ï¼Œåˆ†åˆ«è¡¨ç¤ºè·³è¿‡å’Œé™åˆ¶çš„æ¡æ•°</li>
</ul>
<h4 id="æ’åº">æ’åº<a hidden class="anchor" aria-hidden="true" href="#æ’åº">#</a></h4>
<ul>
<li>sort(): db.orders.find().sort({&lsquo;orderTime&rsquo;: 1, &lsquo;price&rsquo;: 1}) 1: å‡åº 2: é™åº</li>
</ul>
<h4 id="è·³è¿‡å’Œé™åˆ¶">è·³è¿‡å’Œé™åˆ¶<a hidden class="anchor" aria-hidden="true" href="#è·³è¿‡å’Œé™åˆ¶">#</a></h4>
<ul>
<li>
<p>skip(n):è·³è¿‡næ¡æ•°æ®</p>
</li>
<li>
<p>limit(n):é™åˆ¶næ¡æ•°æ®</p>
<p>e.gï¼šorders.find().sort({&lsquo;orderTime&rsquo;: -1}).limit(5).skip(5)</p>
</li>
</ul>
<h4 id="æŸ¥è¯¢å”¯ä¸€å€¼">æŸ¥è¯¢å”¯ä¸€å€¼<a hidden class="anchor" aria-hidden="true" href="#æŸ¥è¯¢å”¯ä¸€å€¼">#</a></h4>
<ul>
<li>
<p>distinct()ï¼šæŸ¥è¯¢æŒ‡å®šå­—æ®µçš„å”¯ä¸€å€¼</p>
<p>e.gï¼šdb.users.distinct(&ldquo;age&rdquo;)</p>
</li>
</ul>
<h3 id="èšåˆæŸ¥è¯¢">èšåˆæŸ¥è¯¢<a hidden class="anchor" aria-hidden="true" href="#èšåˆæŸ¥è¯¢">#</a></h3>
<blockquote>
<p>æˆ‘ä»¬åœ¨æŸ¥è¯¢æ—¶è‚¯å®šå›ç”¨åˆ°èšåˆï¼Œåœ¨MongoDBä¸­èšåˆä¸ºaggregateï¼Œèšåˆå‡½æ•°ä¸»è¦ç”¨åˆ°$matchï¼Œ$groupï¼Œ$avgï¼Œ$projectï¼Œ$concatï¼Œå¯ä»¥åŠ &quot;$match&quot;ä¹Ÿå¯ä»¥ä¸åŠ $match</p>
</blockquote>
<table>
<thead>
<tr>
<th>è¡¨è¾¾å¼</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>$sum</td>
<td>è®¡ç®—æ€»å’Œ</td>
</tr>
<tr>
<td>$avg</td>
<td>è®¡ç®—å¹³å‡å€¼</td>
</tr>
<tr>
<td>$min</td>
<td>è·å–é›†åˆä¸­æ‰€æœ‰æ–‡æ¡£å¯¹åº”å€¼çš„æœ€å°å€¼</td>
</tr>
<tr>
<td>$max</td>
<td>è·å–é›†åˆä¸­æ‰€æœ‰æ–‡æ¡£å¯¹åº”å€¼çš„æœ€å¤§å€¼</td>
</tr>
<tr>
<td>$push</td>
<td>åœ¨ç»“æœæ–‡æ¡£ä¸­æ’å…¥å€¼åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ã€‚</td>
</tr>
<tr>
<td>$addToSet</td>
<td>åœ¨æ–‡æ¡£ä¸­æ’å…¥å€¼åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œä½†ä¸åˆ›å»ºå‰¯æœ¬ã€‚</td>
</tr>
<tr>
<td>$first</td>
<td>æ ¹æ®èµ„æºæ–‡æ¡£çš„æ’åºè·å–ç¬¬ä¸€ä¸ªæ–‡æ¡£æ•°æ®ã€‚</td>
</tr>
<tr>
<td>$last</td>
<td>æ ¹æ®èµ„æºæ–‡æ¡£çš„æ’åºè·å–æœ€åä¸€ä¸ªæ–‡æ¡£æ•°æ®ã€‚</td>
</tr>
</tbody>
</table>
<h4 id="aggregateè¯­æ³•">Aggregateè¯­æ³•<a hidden class="anchor" aria-hidden="true" href="#aggregateè¯­æ³•">#</a></h4>
<blockquote>
<p>åŸºæœ¬æ ¼å¼ï¼š db.collection.aggregate(pipeline, options)</p>
<p>å‚æ•°è¯´æ˜ï¼š</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>ç±»å‹</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>pipeline</td>
<td>array</td>
<td>ä¸€ç³»åˆ—æ•°æ®èšåˆæ“ä½œæˆ–é˜¶æ®µã€‚åœ¨ç‰ˆæœ¬2.6ä¸­æ›´æ”¹ï¼šè¯¥æ–¹æ³•ä»ç„¶å¯ä»¥å°†æµæ°´çº¿é˜¶æ®µä½œä¸ºå•ç‹¬çš„å‚æ•°æ¥å—ï¼Œè€Œä¸æ˜¯ä½œä¸ºæ•°ç»„ä¸­çš„å…ƒç´ ï¼›ä½†æ˜¯å¦‚æœä¸å°†ç®¡é“æŒ‡å®šä¸ºæ•°ç»„ï¼Œåˆ™ä¸èƒ½æŒ‡å®šoptionså‚æ•°ã€‚</td>
</tr>
<tr>
<td>options</td>
<td>document</td>
<td>å¯é€‰ã€‚aggregate()ä¼ é€’ç»™èšåˆå‘½ä»¤çš„å…¶ä»–é€‰é¡¹ã€‚2.6ç‰ˆä¸­çš„æ–°å¢åŠŸèƒ½ï¼šä»…å½“å°†ç®¡é“æŒ‡å®šä¸ºæ•°ç»„æ—¶æ‰å¯ç”¨</td>
</tr>
</tbody>
</table>
</blockquote>
<h4 id="matchå’Œgroup">$matchå’Œ$group<a hidden class="anchor" aria-hidden="true" href="#matchå’Œgroup">#</a></h4>
<blockquote>
<p>ç›¸å½“äºsqlä¸­çš„whereå’Œgroup by</p>
<p>{&quot;$match&quot;:  {&ldquo;å­—æ®µ&rdquo;: &ldquo;æ¡ä»¶&rdquo;}}ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•å¸¸ç”¨æŸ¥è¯¢æ“ä½œç¬¦$gtï¼Œ$ltï¼Œ$inç­‰</p>
<p>{&quot;$group&quot;ï¼š{&quot;_id&quot;: åˆ†ç»„å­—æ®µ, &ldquo;æ–°çš„å­—æ®µå&rdquo;: &ldquo;èšåˆæ“ä½œç¬¦&rdquo;}}</p>
<ol>
<li>å°†åˆ†ç»„å­—æ®µä¼ ç»™$groupå‡½æ•°çš„_idå­—æ®µå³å¯</li>
<li>åˆ†ç»„åèšåˆå¾—åˆ°ç»“æœï¼Œç±»ä¼¼äºsqlä¸­èšåˆå‡½æ•°çš„èšåˆæ“ä½œç¬¦ï¼š$sumã€$avgã€$maxã€$minã€$firstã€$last</li>
</ol>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="o">#</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;$match&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;å­—æ®µ&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;æ¡ä»¶&#34;</span><span class="err">}}ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•å¸¸ç”¨æŸ¥è¯¢æ“ä½œç¬¦$</span><span class="n">gt</span><span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="n">lt</span><span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="n">inç­‰</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">_id</span><span class="w"> </span><span class="n">job</span><span class="p">,</span><span class="w"> </span><span class="k">avg</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span><span class="w"> </span><span class="n">avg_salary</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">db</span><span class="p">.</span><span class="n">emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">depno</span><span class="o">=</span><span class="mi">30</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">job</span><span class="p">;</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">emp</span><span class="p">.</span><span class="k">aggregate</span><span class="p">([</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="s2">&#34;$match&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;depno&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;$eq&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="err">}}}</span><span class="p">,</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="s2">&#34;$group&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;_id&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;$job&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;avg_salary&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;$avg&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;$sal&#34;</span><span class="err">}}}</span><span class="w">
</span><span class="w"></span><span class="p">])</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">_id</span><span class="w"> </span><span class="n">job</span><span class="p">,</span><span class="w"> </span><span class="k">avg</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span><span class="w"> </span><span class="n">avg_salary</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">db</span><span class="p">.</span><span class="n">emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">depno</span><span class="o">=</span><span class="mi">30</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">job</span><span class="w"> </span><span class="k">having</span><span class="w"> </span><span class="n">avg_salary</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">2000</span><span class="p">;</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">emp</span><span class="p">.</span><span class="k">aggregate</span><span class="p">([</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="s2">&#34;$match&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;depno&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;$eq&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="err">}}}</span><span class="p">,</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="s2">&#34;$group&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;_id&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;$job&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;avg_salary&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;$avg&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;$sal&#34;</span><span class="err">}}}</span><span class="p">,</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="s2">&#34;$match&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;avg_salary&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;$gt&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">2000</span><span class="err">}}}</span><span class="w">
</span><span class="w"></span><span class="p">])</span><span class="w">
</span></code></pre></div><p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/rex0520/resources_repository/images/20210709153836.png" alt="image-20210709153828201"  />
</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/rex0520/resources_repository/images/20210709153904.png" alt="image-20210709153904574"  />
</p>
<h4 id="project">$project<a hidden class="anchor" aria-hidden="true" href="#project">#</a></h4>
<blockquote>
<p>ç”¨äºæŠ•å°„ï¼Œå³è®¾å®šè¯¥é”®å€¼å¯¹æ˜¯å¦ä¿ç•™ã€‚1ä¸ºä¿ç•™ï¼Œ0ä¸ºä¸ä¿ç•™ï¼Œå¯å¯¹åŸæœ‰é”®å€¼å¯¹åšæ“ä½œåå¢åŠ è‡ªå®šä¹‰è¡¨è¾¾å¼(æŸ¥è¯¢å“ªäº›è¦æ˜¾ç¤ºçš„åˆ—)</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="err">{</span><span class="s2">&#34;$project&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;è¦ä¿ç•™çš„å­—æ®µå&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;è¦å»æ‰çš„å­—æ®µå&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;æ–°å¢çš„å­—æ®µå&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;è¡¨è¾¾å¼&#34;</span><span class="err">}}</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">emp</span><span class="p">.</span><span class="k">aggregate</span><span class="p">()</span><span class="w">
</span><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">ename</span><span class="p">,</span><span class="w"> </span><span class="n">job</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">sal</span><span class="o">+</span><span class="mi">400</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">new_sal</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">db</span><span class="p">.</span><span class="n">emp</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">emp</span><span class="p">.</span><span class="k">aggregate</span><span class="p">([</span><span class="err">{</span><span class="w">
</span><span class="w">	</span><span class="err">$</span><span class="n">project</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">
</span><span class="w">		</span><span class="s2">&#34;ename&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
</span><span class="w">		</span><span class="s2">&#34;job&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
</span><span class="w">		</span><span class="s2">&#34;new_sal&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">
</span><span class="w">			</span><span class="s2">&#34;$add&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;$sal&#34;</span><span class="p">,</span><span class="w"> </span><span class="mi">400</span><span class="p">]</span><span class="w">
</span><span class="w">		</span><span class="err">}</span><span class="w">
</span><span class="w">	</span><span class="err">}</span><span class="w">
</span><span class="w"></span><span class="err">}</span><span class="p">])</span><span class="w">
</span></code></pre></div><p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/rex0520/resources_repository/images/20210709153807.png" alt="image-20210709153758768"  />
</p>
<h4 id="sortå’Œlimitå’Œskip">$sortå’Œ$limitå’Œ$skip<a hidden class="anchor" aria-hidden="true" href="#sortå’Œlimitå’Œskip">#</a></h4>
<blockquote>
<p>æ’åºï¼š{&quot;$sort&quot;: {&ldquo;å­—æ®µå&rdquo;: 1, â€œå­—æ®µåâ€: -1}} #1å‡åºï¼Œ-1é™åº</p>
<p>é™åˆ¶ï¼š{&quot;$limit&quot;: n}</p>
<p>è·³è¿‡ï¼š{&quot;$skip&quot;: n} #è·³è¿‡å¤šå°‘ä¸ªæ–‡æ¡£</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="o">#</span><span class="w"> </span><span class="err">ä¾‹</span><span class="mi">1</span><span class="err">ã€å–å¹³å‡å·¥èµ„æœ€é«˜çš„å‰ä¸¤ä¸ªå·¥ä½œ</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">emp</span><span class="p">.</span><span class="k">aggregate</span><span class="p">([</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="w">
</span><span class="w">		</span><span class="s2">&#34;$group&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;_id&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;$job&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;avg_sal&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;$avg&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;$sal&#34;</span><span class="err">}}</span><span class="w">
</span><span class="w">	</span><span class="err">}</span><span class="p">,</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="w">
</span><span class="w">		</span><span class="s2">&#34;$sort&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;avg_sal&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="err">}</span><span class="w">
</span><span class="w">	</span><span class="err">}</span><span class="p">,</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="w">
</span><span class="w">		</span><span class="s2">&#34;$limit&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="w">	</span><span class="err">}</span><span class="w">
</span><span class="w"></span><span class="p">])</span><span class="w">
</span><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">ä¾‹</span><span class="mi">2</span><span class="err">ã€å–å¹³å‡å·¥èµ„æœ€é«˜çš„ç¬¬äºŒä¸ªéƒ¨é—¨</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">emp</span><span class="p">.</span><span class="k">aggregate</span><span class="p">([</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="w">
</span><span class="w">		</span><span class="s2">&#34;$group&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;_id&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;$job&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;avg_sal&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;$avg&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;$sal&#34;</span><span class="err">}}</span><span class="w">
</span><span class="w">	</span><span class="err">}</span><span class="p">,</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="w">
</span><span class="w">		</span><span class="s2">&#34;$sort&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="s2">&#34;avg_sal&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="err">}</span><span class="w">
</span><span class="w">	</span><span class="err">}</span><span class="p">,</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="w">
</span><span class="w">		</span><span class="s2">&#34;$skip&#34;</span><span class="p">:</span><span class="mi">1</span><span class="w">
</span><span class="w">	</span><span class="err">}</span><span class="p">,</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="w">
</span><span class="w">		</span><span class="s2">&#34;$limit&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="w">	</span><span class="err">}</span><span class="w">
</span><span class="w"></span><span class="p">])</span><span class="w">
</span></code></pre></div><h4 id="sample">$sample<a hidden class="anchor" aria-hidden="true" href="#sample">#</a></h4>
<blockquote>
<p>éšæœºé€‰å–nä¸ªï¼š$sample</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="n">db</span><span class="p">.</span><span class="n">emp</span><span class="p">.</span><span class="k">aggregate</span><span class="p">([</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="s2">&#34;$sample&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="k">size</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="err">}}</span><span class="w">
</span><span class="w"></span><span class="p">])</span><span class="w">
</span></code></pre></div><h2 id="ä¿®æ”¹æ–‡æ¡£">ä¿®æ”¹æ–‡æ¡£<a hidden class="anchor" aria-hidden="true" href="#ä¿®æ”¹æ–‡æ¡£">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="cm">/*
</span><span class="cm">	ä¿®æ”¹
</span><span class="cm">		db.collection.update(æŸ¥è¯¢æ¡ä»¶ï¼Œæ–°å¯¹è±¡)
</span><span class="cm">			- update()é»˜è®¤æƒ…å†µä¸‹ä¼šä½¿ç”¨æ–°å¯¹è±¡æ¥æ›¿æ¢æ—§å¯¹è±¡(æ—§ç‰ˆæœ¬)
</span><span class="cm">			- update()æ—§ç‰ˆæœ¬æ–°å¯¹è±¡ä¸å†™å…¨æˆ–æ˜¯ä¸ç”¨$setï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šæŠ¥é”™
</span><span class="cm">				(Invalid key &#39;age&#39;: update only works with $ operators and pipelines)
</span><span class="cm">			- å¦‚æœéœ€è¦ä¿®æ”¹æŒ‡å®šçš„å±æ€§ï¼Œè€Œä¸æ˜¯æ›¿æ¢éœ€è¦ä½¿ç”¨&#34;ä¿®æ”¹æ“ä½œç¬¦&#34;æ¥å®Œæˆä¿®æ”¹
</span><span class="cm">				$set å¯ä»¥ç”¨æ¥ä¿®æ”¹æ–‡æ¡£ä¸­çš„æŒ‡å®šå±æ€§
</span><span class="cm">				$unset å¯ä»¥ç”¨æ¥åˆ é™¤æ–‡æ¡£ä¸­çš„æŒ‡å®šå±æ€§
</span><span class="cm">			- update()é»˜è®¤åªä¿®æ”¹ä¸€ä¸ª
</span><span class="cm">		db.collection.updateMany()
</span><span class="cm">			- åŒæ—¶ä¿®æ”¹å¤šä¸ªç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£
</span><span class="cm">		db.collection.updateOne()
</span><span class="cm">			- ä¿®æ”¹ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£
</span><span class="cm">*/</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="n">find</span><span class="p">()</span><span class="w">
</span><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">æ›¿æ¢</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="k">update</span><span class="p">(</span><span class="err">{</span><span class="n">name</span><span class="p">:</span><span class="s2">&#34;shasen&#34;</span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="err">{</span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="err">}</span><span class="p">)</span><span class="w"> 
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="k">update</span><span class="p">(</span><span class="err">{</span><span class="n">name</span><span class="p">:</span><span class="s2">&#34;shasen&#34;</span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="err">{$</span><span class="k">set</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="err">}}</span><span class="p">)</span><span class="w"> 
</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="k">update</span><span class="p">(</span><span class="err">{</span><span class="n">_id</span><span class="p">:</span><span class="w"> </span><span class="n">ObjectId</span><span class="p">(</span><span class="s2">&#34;60da92e09e15000095005504&#34;</span><span class="p">)</span><span class="err">}</span><span class="p">,</span><span class="err">{$</span><span class="k">set</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="n">name</span><span class="p">:</span><span class="s2">&#34;shaheshang&#34;</span><span class="err">}}</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="err">{</span><span class="n">_id</span><span class="p">:</span><span class="w"> </span><span class="n">ObjectId</span><span class="p">(</span><span class="s2">&#34;60da92e09e15000095005504&#34;</span><span class="p">)</span><span class="err">}</span><span class="p">)</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="k">update</span><span class="p">(</span><span class="err">{</span><span class="n">_id</span><span class="p">:</span><span class="w"> </span><span class="n">ObjectId</span><span class="p">(</span><span class="s2">&#34;60da92e09e15000095005504&#34;</span><span class="p">)</span><span class="err">}</span><span class="p">,</span><span class="err">{</span><span class="w">
</span><span class="w">	</span><span class="err">$</span><span class="k">set</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">
</span><span class="w">		</span><span class="n">gender</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;ç”·&#34;</span><span class="p">,</span><span class="w">
</span><span class="w">		</span><span class="n">address</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;æµæ²™æ²³&#34;</span><span class="w">
</span><span class="w">	</span><span class="err">}</span><span class="w">
</span><span class="w"></span><span class="err">}</span><span class="p">)</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="k">update</span><span class="p">(</span><span class="err">{</span><span class="n">_id</span><span class="p">:</span><span class="w"> </span><span class="n">ObjectId</span><span class="p">(</span><span class="s2">&#34;60da92e09e15000095005504&#34;</span><span class="p">)</span><span class="err">}</span><span class="p">,</span><span class="err">{</span><span class="w">
</span><span class="w">	</span><span class="err">$</span><span class="n">unset</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">
</span><span class="w">		</span><span class="n">address</span><span class="p">:</span><span class="mi">1</span><span class="w">
</span><span class="w">	</span><span class="err">}</span><span class="w">
</span><span class="w"></span><span class="err">}</span><span class="p">)</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="n">updateMany</span><span class="p">(</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;zhubajie&#34;</span><span class="err">}</span><span class="p">,</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="w">
</span><span class="w">		</span><span class="err">$</span><span class="k">set</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">
</span><span class="w">			</span><span class="n">address</span><span class="p">:</span><span class="s2">&#34;zhulaozhuang&#34;</span><span class="w">
</span><span class="w">		</span><span class="err">}</span><span class="w">
</span><span class="w">	</span><span class="err">}</span><span class="w">
</span><span class="w"></span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="k">update</span><span class="p">(</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;zhubajie&#34;</span><span class="err">}</span><span class="p">,</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="w">
</span><span class="w">		</span><span class="err">$</span><span class="k">set</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">
</span><span class="w">			</span><span class="n">address</span><span class="p">:</span><span class="s2">&#34;zhulaozhuang&#34;</span><span class="w">
</span><span class="w">		</span><span class="err">}</span><span class="w">
</span><span class="w">	</span><span class="err">}</span><span class="w">
</span><span class="w"></span><span class="p">)</span><span class="w">
</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="k">update</span><span class="p">(</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;zhubajie&#34;</span><span class="err">}</span><span class="p">,</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="w">
</span><span class="w">		</span><span class="err">$</span><span class="k">set</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">
</span><span class="w">			</span><span class="n">address</span><span class="p">:</span><span class="s2">&#34;hehehe&#34;</span><span class="w">
</span><span class="w">		</span><span class="err">}</span><span class="w">
</span><span class="w">	</span><span class="err">}</span><span class="p">,</span><span class="w">
</span><span class="w">	</span><span class="err">{</span><span class="w">
</span><span class="w">		</span><span class="n">multi</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="w">
</span><span class="w">	</span><span class="err">}</span><span class="w">
</span><span class="w"></span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="n">find</span><span class="p">()</span><span class="w">
</span><span class="w">
</span></code></pre></div><h2 id="åˆ é™¤æ–‡æ¡£">åˆ é™¤æ–‡æ¡£<a hidden class="anchor" aria-hidden="true" href="#åˆ é™¤æ–‡æ¡£">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="cm">/*
</span><span class="cm">	åˆ é™¤
</span><span class="cm">	db.collection.remove()
</span><span class="cm">		-- åˆ é™¤ç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰æ–‡æ¡£(é»˜è®¤æƒ…å†µä¸‹ä¼šåˆ é™¤å¤šä¸ª)
</span><span class="cm">				å¦‚æœremove()ç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ä¸€ä¸ªtrueï¼Œåˆ™åªä¼šåˆ é™¤ä¸€ä¸ª
</span><span class="cm">		-- å¦‚æœå€¼ä¼ é€’ä¸€ä¸ªç©ºå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œåˆ™ä¼šåˆ é™¤ç»“åˆä¸­çš„æ‰€æœ‰æ–‡æ¡£		
</span><span class="cm">	db.collection.deleteOne()
</span><span class="cm">	db.collection.deleteMany()
</span><span class="cm">		-- remove()å¯ä»¥æ ¹æ®æ¡ä»¶æ¥åˆ é™¤æ–‡æ¡£ï¼Œä¼ é€’çš„æ¡ä»¶æ–¹å¼å’Œfind()ä¸€æ ·
</span><span class="cm">	db.collection.drop();
</span><span class="cm">		-- åˆ é™¤é›†åˆ
</span><span class="cm">	db.dropDatabase() åˆ é™¤æ•°æ®åº“
</span><span class="cm">		-- æ•°æ®åº“ä¸­çš„æ•°æ®éƒ½å¹¶ä¸ä¼šåˆ é™¤ï¼Œæ‰€ä»¥åˆ é™¤çš„æ–¹æ³•å¾ˆå°‘è°ƒç”¨
</span><span class="cm">			ä¸€èˆ¬ä¼šåœ¨æ•°æ®ä¸­æ·»åŠ ä¸€ä¸ªå­—æ®µï¼Œæ¥è¡¨ç¤ºæ•°æ®æ˜¯å¦è¢«åˆ é™¤
</span><span class="cm">*/</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="err">{</span><span class="n">_id</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;hello&#34;</span><span class="err">}</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="n">find</span><span class="p">()</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="k">insert</span><span class="p">([</span><span class="err">{</span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="err">{</span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="err">}</span><span class="p">])</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="err">{</span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="k">true</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">æ¸…ç©ºé›†åˆ</span><span class="p">(</span><span class="err">æ€§èƒ½ç•¥å·®</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="err">{}</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="k">show</span><span class="w"> </span><span class="n">collections</span><span class="p">;</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">stus</span><span class="p">.</span><span class="k">drop</span><span class="p">()</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">show</span><span class="w"> </span><span class="n">dbs</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">db</span><span class="p">.</span><span class="n">dropDatabase</span><span class="p">();</span><span class="w">
</span></code></pre></div><h2 id="æ–‡æ¡£å…³ç³»">æ–‡æ¡£å…³ç³»<a hidden class="anchor" aria-hidden="true" href="#æ–‡æ¡£å…³ç³»">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="cm">/*
</span><span class="cm">	æ–‡æ¡£ä¹‹é—´çš„å…³ç³»
</span><span class="cm">		ä¸€å¯¹ä¸€(one to one)
</span><span class="cm">			-- å¤«å¦»(ä¸€ä¸ªä¸ˆå¤« å¯¹åº” ä¸€ä¸ªå¦»å­)
</span><span class="cm">			-- åœ¨MongoDBï¼Œå¯ä»¥é€šè¿‡å†…åµŒæ–‡æ¡£çš„å½¢å¼æ¥ä½“ç°å‡ºä¸€å¯¹ä¸€çš„å…³ç³»
</span><span class="cm">		ä¸€å¯¹å¤š(one to many) / å¤šå¯¹ä¸€(many to one)
</span><span class="cm">			-- çˆ¶æ¯ - å­©å­
</span><span class="cm">				 ç”¨æˆ· - è®¢å•
</span><span class="cm">				 æ–‡ç«  - è¯„è®º
</span><span class="cm">				 - ä¹Ÿå¯ä»¥é€šè¿‡å†…åµŒæ–‡æ¡£æ¥æ˜ å°„ä¸€å¯¹å¤šçš„å…³ç³»
</span><span class="cm">		å¤šå¯¹å¤š(many to many)
</span><span class="cm">			-- åˆ†ç±» - å•†å“
</span><span class="cm">				 è€å¸ˆ - å­¦ç”Ÿ
</span><span class="cm">*/</span>

<span class="nx">db</span><span class="p">.</span><span class="nx">wifeAndHusband</span><span class="p">.</span><span class="nx">insert</span><span class="p">([</span>
	<span class="p">{</span>
		<span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;é»„è“‰&#34;</span><span class="p">,</span>
		<span class="nx">husband</span><span class="o">:</span> <span class="p">{</span>
			<span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;éƒ­é–&#34;</span>
		<span class="p">}</span>
	<span class="p">},{</span>
		<span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;æ½˜é‡‘è²&#34;</span><span class="p">,</span>
		<span class="nx">husband</span><span class="o">:</span> <span class="p">{</span>
			<span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;æ­¦å¤§éƒ&#34;</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">]);</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">wifeAndHusband</span><span class="p">.</span><span class="nx">find</span><span class="p">()</span>
<span class="c1">// ä¸€å¯¹å¤š ç”¨æˆ·(users) å’Œ è®¢å•()
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">insert</span><span class="p">([</span>
	<span class="p">{</span>
		<span class="nx">username</span><span class="o">:</span> <span class="s2">&#34;swk&#34;</span>
	<span class="p">},{</span>
		<span class="nx">username</span><span class="o">:</span> <span class="s2">&#34;zbj&#34;</span>
	<span class="p">}</span>
<span class="p">])</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">find</span><span class="p">()</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">order</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span>
	<span class="nx">list</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;ç‰›è‚‰&#34;</span><span class="p">,</span> <span class="s2">&#34;æ¼«ç”»&#34;</span><span class="p">],</span>
	<span class="nx">user_id</span><span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;60dbc477c673000085000595&#34;</span><span class="p">)</span>
<span class="p">})</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">order</span><span class="p">.</span><span class="nx">find</span><span class="p">()</span>

<span class="c1">// æŸ¥æ‰¾ç”¨æˆ·swkçš„è®¢å•
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">user_id</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span><span class="nx">username</span><span class="o">:</span> <span class="s2">&#34;zbj&#34;</span><span class="p">}).</span><span class="mi">_</span><span class="nx">id</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">order</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">user_id</span><span class="o">:</span> <span class="nx">user_id</span><span class="p">})</span>

<span class="c1">// å¤šå¯¹å¤š
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">teachers</span><span class="p">.</span><span class="nx">insert</span><span class="p">([</span>
	<span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;æ´ªä¸ƒå…¬&#34;</span><span class="p">},</span>
	<span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;é»„è¯å¸ˆ&#34;</span><span class="p">},</span>
	<span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;é¾Ÿä»™äºº&#34;</span><span class="p">}</span>
<span class="p">])</span>

<span class="nx">db</span><span class="p">.</span><span class="nx">stus</span><span class="p">.</span><span class="nx">insert</span><span class="p">([{</span>
		<span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;éƒ­é–&#34;</span><span class="p">,</span>
		<span class="nx">tech_ids</span><span class="o">:</span> <span class="p">[</span>
			<span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;60dbc694c67300008500059a&#34;</span><span class="p">),</span>
			<span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;60dbc694c67300008500059b&#34;</span><span class="p">)</span>
		<span class="p">]</span>
	<span class="p">},{</span>
		<span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;å­™æ‚Ÿç©º&#34;</span><span class="p">,</span>
		<span class="nx">tech_ids</span><span class="o">:</span> <span class="p">[</span>
			<span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;60dbc694c67300008500059a&#34;</span><span class="p">),</span>
			<span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;60dbc694c67300008500059b&#34;</span><span class="p">),</span>
			<span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;60dbc694c67300008500059c&#34;</span><span class="p">)</span>
		<span class="p">]</span>
	<span class="p">}</span>
<span class="p">])</span>

<span class="nx">db</span><span class="p">.</span><span class="nx">teachers</span><span class="p">.</span><span class="nx">find</span><span class="p">()</span>

<span class="nx">db</span><span class="p">.</span><span class="nx">stus</span><span class="p">.</span><span class="nx">find</span><span class="p">()</span>
</code></pre></div><h2 id="test">Test<a hidden class="anchor" aria-hidden="true" href="#test">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">//17.å‘numbersä¸­æ’å…¥20000æ¡æ•°æ®
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="mi">20000</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
	<span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="nx">num</span><span class="o">:</span> <span class="nx">i</span><span class="p">});</span>
<span class="p">}</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">numbers</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span>
<span class="c1">//18.æŸ¥è¯¢numbersä¸­numä¸º500çš„æ–‡æ¡£
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">numbers</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">num</span><span class="o">:</span> <span class="mi">500</span><span class="p">})</span>
<span class="c1">//19.æŸ¥è¯¢numbersä¸­numå¤§äº5000çš„æ–‡æ¡£
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">numbers</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">num</span><span class="o">:</span> <span class="p">{</span><span class="nx">$gt</span><span class="o">:</span> <span class="mi">5000</span><span class="p">}})</span>
<span class="c1">//20.æŸ¥è¯¢numbersä¸­numå°äº30çš„æ–‡æ¡£
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">numbers</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">num</span><span class="o">:</span> <span class="p">{</span><span class="nx">$lt</span><span class="o">:</span> <span class="mi">30</span><span class="p">}})</span>
<span class="c1">//21.æŸ¥è¯¢numbersä¸­numå¤§äº40å°äº50çš„æ–‡æ¡£
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">numbers</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">num</span><span class="o">:</span> <span class="p">{</span><span class="nx">$gt</span><span class="o">:</span> <span class="mi">40</span><span class="p">,</span> <span class="nx">$lt</span><span class="o">:</span> <span class="mi">50</span><span class="p">}})</span>
<span class="c1">//22.æŸ¥è¯¢numbersä¸­numå¤§äº19996çš„æ–‡æ¡£
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">numbers</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">num</span><span class="o">:</span> <span class="p">{</span><span class="nx">$gt</span><span class="o">:</span> <span class="mi">19996</span><span class="p">}})</span>
<span class="c1">//23.æŸ¥çœ‹numbersé›†åˆä¸­çš„å‰10æ¡æ•°æ®
</span><span class="c1">//limit()è®¾ç½®æ˜¾ç¤ºæ•°æ®çš„ä¸Šé™
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">numbers</span><span class="p">.</span><span class="nx">find</span><span class="p">({}).</span><span class="nx">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="c1">//åœ¨å¼€å‘æ—¶ï¼Œæˆ‘ä»¬ç»å¯¹ä¸ä¼šæ‰§è¡Œä¸å¸¦æ¡ä»¶çš„æŸ¥è¯¢
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">numbers</span><span class="p">.</span><span class="nx">find</span><span class="p">({})</span>
<span class="c1">//24.æŸ¥çœ‹numbersé›†åˆä¸­çš„ç¬¬11æ¡åˆ°20æ¡æ•°æ®
</span><span class="c1">//skip()ç”¨äºè·³è¿‡æŒ‡å®šæ•°é‡çš„æ•°æ®
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">numbers</span><span class="p">.</span><span class="nx">find</span><span class="p">({}).</span><span class="nx">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="nx">skip</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="c1">//25.æŸ¥çœ‹numbersé›†åˆä¸­çš„ç¬¬21æ¡åˆ°30æ¡æ•°æ®
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">numbers</span><span class="p">.</span><span class="nx">find</span><span class="p">({}).</span><span class="nx">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="nx">skip</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="c1">//26.å°†deptå’Œempé›†åˆå¯¼å…¥åˆ°æ•°æ®åº“ä¸­
</span><span class="c1"></span>
<span class="c1">//27.æŸ¥è¯¢å·¥èµ„å°äº2000çš„å‘˜å·¥
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">emp</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">sal</span><span class="o">:</span> <span class="p">{</span><span class="nx">$lt</span><span class="o">:</span> <span class="mi">2000</span><span class="p">}})</span>
<span class="c1">//28.æŸ¥è¯¢å·¥èµ„åœ¨1000-2000ä¹‹é—´çš„å‘˜å·¥
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">emp</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">sal</span><span class="o">:</span> <span class="p">{</span><span class="nx">$gt</span><span class="o">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="nx">$lt</span><span class="o">:</span> <span class="mi">2000</span><span class="p">}})</span>
<span class="c1">//29.æŸ¥è¯¢å·¥èµ„å°äº1000æˆ–å¤§äº2500çš„å‘˜å·¥
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">emp</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span>
	<span class="nx">$or</span><span class="o">:</span> <span class="p">[</span>
		<span class="p">{</span><span class="nx">sal</span><span class="o">:</span> <span class="p">{</span><span class="nx">$lt</span><span class="o">:</span> <span class="mi">1000</span><span class="p">}},</span>
		<span class="p">{</span><span class="nx">sal</span><span class="o">:</span> <span class="p">{</span><span class="nx">$gt</span><span class="o">:</span> <span class="mi">2500</span><span class="p">}}</span>
	<span class="p">]</span>
<span class="p">});</span>
<span class="c1">//30.æŸ¥è¯¢è´¢åŠ¡éƒ¨çš„æ‰€æœ‰å‘˜å·¥
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">deptno</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">dep</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span><span class="nx">dname</span><span class="o">:</span> <span class="s2">&#34;è´¢åŠ¡éƒ¨&#34;</span><span class="p">}).</span><span class="nx">deptno</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">emp</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">depno</span><span class="o">:</span> <span class="nx">deptno</span><span class="p">})</span>
<span class="c1">//31.æŸ¥è¯¢é”€å”®éƒ¨çš„æ‰€æœ‰å‘˜å·¥
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">deptno</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">dep</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span><span class="nx">dname</span><span class="o">:</span> <span class="s2">&#34;é”€å”®éƒ¨&#34;</span><span class="p">}).</span><span class="nx">deptno</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">emp</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">depno</span><span class="o">:</span> <span class="nx">deptno</span><span class="p">})</span>
<span class="c1">//32.æŸ¥è¯¢æ‰€æœ‰mgrä¸º7698çš„æ‰€æœ‰å‘˜å·¥
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">emp</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">mgr</span><span class="o">:</span> <span class="mi">7698</span><span class="p">})</span>
<span class="c1">//33.ä¸ºæ‰€æœ‰è–ªèµ„ä½äº1000çš„å‘˜å·¥å¢åŠ å·¥èµ„400å…ƒ
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">emp</span><span class="p">.</span><span class="nx">updateMany</span><span class="p">({</span><span class="nx">sal</span><span class="o">:</span> <span class="p">{</span><span class="nx">$lte</span><span class="o">:</span> <span class="mi">1000</span><span class="p">}},</span> <span class="p">{</span>
			<span class="nx">$inc</span><span class="o">:</span> <span class="p">{</span>
				<span class="nx">sal</span><span class="o">:</span> <span class="mi">400</span>
			<span class="p">}</span> 
	<span class="p">}</span>
<span class="p">)</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">emp</span><span class="p">.</span><span class="nx">find</span><span class="p">()</span>
</code></pre></div><p>emp:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="err">ObjectId(</span><span class="s2">&#34;5941f5bfc1bc86928f4de4ac&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;empno&#34;</span> <span class="p">:</span> <span class="mf">7369.0</span><span class="p">,</span>
  <span class="nt">&#34;ename&#34;</span> <span class="p">:</span> <span class="s2">&#34;æ—å†²&#34;</span><span class="p">,</span>
  <span class="nt">&#34;job&#34;</span> <span class="p">:</span> <span class="s2">&#34;èŒå‘˜&#34;</span><span class="p">,</span>
  <span class="nt">&#34;mgr&#34;</span> <span class="p">:</span> <span class="mf">7902.0</span><span class="p">,</span>
  <span class="nt">&#34;hiredate&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;1980-12-16T16:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;sal&#34;</span> <span class="p">:</span> <span class="mf">800.0</span><span class="p">,</span>
  <span class="nt">&#34;depno&#34;</span> <span class="p">:</span> <span class="mf">20.0</span>
<span class="p">}</span>
<span class="p">{</span>
  <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="err">ObjectId(</span><span class="s2">&#34;5941f5bfc1bc86928f4de4ad&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;empno&#34;</span> <span class="p">:</span> <span class="mf">7499.0</span><span class="p">,</span>
  <span class="nt">&#34;ename&#34;</span> <span class="p">:</span> <span class="s2">&#34;å­™äºŒå¨˜&#34;</span><span class="p">,</span>
  <span class="nt">&#34;job&#34;</span> <span class="p">:</span> <span class="s2">&#34;é”€å”®&#34;</span><span class="p">,</span>
  <span class="nt">&#34;mgr&#34;</span> <span class="p">:</span> <span class="mf">7698.0</span><span class="p">,</span>
  <span class="nt">&#34;hiredate&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;1981-02-19T16:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;sal&#34;</span> <span class="p">:</span> <span class="mf">1600.0</span><span class="p">,</span>
  <span class="nt">&#34;comm&#34;</span> <span class="p">:</span> <span class="mf">300.0</span><span class="p">,</span>
  <span class="nt">&#34;depno&#34;</span> <span class="p">:</span> <span class="mf">30.0</span>
<span class="p">}</span>
<span class="p">{</span>
  <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="err">ObjectId(</span><span class="s2">&#34;5941f5bfc1bc86928f4de4ae&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;empno&#34;</span> <span class="p">:</span> <span class="mf">7521.0</span><span class="p">,</span>
  <span class="nt">&#34;ename&#34;</span> <span class="p">:</span> <span class="s2">&#34;æ‰ˆä¸‰å¨˜&#34;</span><span class="p">,</span>
  <span class="nt">&#34;job&#34;</span> <span class="p">:</span> <span class="s2">&#34;é”€å”®&#34;</span><span class="p">,</span>
  <span class="nt">&#34;mgr&#34;</span> <span class="p">:</span> <span class="mf">7698.0</span><span class="p">,</span>
  <span class="nt">&#34;hiredate&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;1981-02-21T16:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;sal&#34;</span> <span class="p">:</span> <span class="mf">1250.0</span><span class="p">,</span>
  <span class="nt">&#34;comm&#34;</span> <span class="p">:</span> <span class="mf">500.0</span><span class="p">,</span>
  <span class="nt">&#34;depno&#34;</span> <span class="p">:</span> <span class="mf">30.0</span>
<span class="p">}</span>
<span class="p">{</span>
  <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="err">ObjectId(</span><span class="s2">&#34;5941f5bfc1bc86928f4de4af&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;empno&#34;</span> <span class="p">:</span> <span class="mf">7566.0</span><span class="p">,</span>
  <span class="nt">&#34;ename&#34;</span> <span class="p">:</span> <span class="s2">&#34;å¢ä¿Šä¹‰&#34;</span><span class="p">,</span>
  <span class="nt">&#34;job&#34;</span> <span class="p">:</span> <span class="s2">&#34;ç»ç†&#34;</span><span class="p">,</span>
  <span class="nt">&#34;mgr&#34;</span> <span class="p">:</span> <span class="mf">7839.0</span><span class="p">,</span>
  <span class="nt">&#34;hiredate&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;1981-04-01T16:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;sal&#34;</span> <span class="p">:</span> <span class="mf">2975.0</span><span class="p">,</span>
  <span class="nt">&#34;depno&#34;</span> <span class="p">:</span> <span class="mf">20.0</span>
<span class="p">}</span>
<span class="p">{</span>
  <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="err">ObjectId(</span><span class="s2">&#34;5941f5bfc1bc86928f4de4b0&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;empno&#34;</span> <span class="p">:</span> <span class="mf">7654.0</span><span class="p">,</span>
  <span class="nt">&#34;ename&#34;</span> <span class="p">:</span> <span class="s2">&#34;æ½˜é‡‘è²&#34;</span><span class="p">,</span>
  <span class="nt">&#34;job&#34;</span> <span class="p">:</span> <span class="s2">&#34;é”€å”®&#34;</span><span class="p">,</span>
  <span class="nt">&#34;mgr&#34;</span> <span class="p">:</span> <span class="mf">7698.0</span><span class="p">,</span>
  <span class="nt">&#34;hiredate&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;1981-09-27T16:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;sal&#34;</span> <span class="p">:</span> <span class="mf">1250.0</span><span class="p">,</span>
  <span class="nt">&#34;comm&#34;</span> <span class="p">:</span> <span class="mf">1400.0</span><span class="p">,</span>
  <span class="nt">&#34;depno&#34;</span> <span class="p">:</span> <span class="mf">30.0</span>
<span class="p">}</span>
<span class="p">{</span>
  <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="err">ObjectId(</span><span class="s2">&#34;5941f5bfc1bc86928f4de4b1&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;empno&#34;</span> <span class="p">:</span> <span class="mf">7698.0</span><span class="p">,</span>
  <span class="nt">&#34;ename&#34;</span> <span class="p">:</span> <span class="s2">&#34;è¥¿é—¨åº†&#34;</span><span class="p">,</span>
  <span class="nt">&#34;job&#34;</span> <span class="p">:</span> <span class="s2">&#34;ç»ç†&#34;</span><span class="p">,</span>
  <span class="nt">&#34;mgr&#34;</span> <span class="p">:</span> <span class="mf">7839.0</span><span class="p">,</span>
  <span class="nt">&#34;hiredate&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;1981-04-30T16:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;sal&#34;</span> <span class="p">:</span> <span class="mf">2850.0</span><span class="p">,</span>
  <span class="nt">&#34;depno&#34;</span> <span class="p">:</span> <span class="mf">30.0</span>
<span class="p">}</span>
<span class="p">{</span>
  <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="err">ObjectId(</span><span class="s2">&#34;5941f5bfc1bc86928f4de4b2&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;empno&#34;</span> <span class="p">:</span> <span class="mf">7782.0</span><span class="p">,</span>
  <span class="nt">&#34;ename&#34;</span> <span class="p">:</span> <span class="s2">&#34;æŸ´è¿›&#34;</span><span class="p">,</span>
  <span class="nt">&#34;job&#34;</span> <span class="p">:</span> <span class="s2">&#34;ç»ç†&#34;</span><span class="p">,</span>
  <span class="nt">&#34;mgr&#34;</span> <span class="p">:</span> <span class="mf">7839.0</span><span class="p">,</span>
  <span class="nt">&#34;hiredate&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;1981-06-08T16:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;sal&#34;</span> <span class="p">:</span> <span class="mf">2450.0</span><span class="p">,</span>
  <span class="nt">&#34;depno&#34;</span> <span class="p">:</span> <span class="mf">10.0</span>
<span class="p">}</span>
<span class="p">{</span>
  <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="err">ObjectId(</span><span class="s2">&#34;5941f5bfc1bc86928f4de4b3&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;empno&#34;</span> <span class="p">:</span> <span class="mf">7788.0</span><span class="p">,</span>
  <span class="nt">&#34;ename&#34;</span> <span class="p">:</span> <span class="s2">&#34;å…¬å­™èƒœ&#34;</span><span class="p">,</span>
  <span class="nt">&#34;job&#34;</span> <span class="p">:</span> <span class="s2">&#34;åˆ†æå¸ˆ&#34;</span><span class="p">,</span>
  <span class="nt">&#34;mgr&#34;</span> <span class="p">:</span> <span class="mf">7566.0</span><span class="p">,</span>
  <span class="nt">&#34;hiredate&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;1987-07-12T16:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;sal&#34;</span> <span class="p">:</span> <span class="mf">3000.0</span><span class="p">,</span>
  <span class="nt">&#34;depno&#34;</span> <span class="p">:</span> <span class="mf">20.0</span>
<span class="p">}</span>
<span class="p">{</span>
  <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="err">ObjectId(</span><span class="s2">&#34;5941f5bfc1bc86928f4de4b4&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;empno&#34;</span> <span class="p">:</span> <span class="mf">7839.0</span><span class="p">,</span>
  <span class="nt">&#34;ename&#34;</span> <span class="p">:</span> <span class="s2">&#34;å®‹æ±Ÿ&#34;</span><span class="p">,</span>
  <span class="nt">&#34;job&#34;</span> <span class="p">:</span> <span class="s2">&#34;è‘£äº‹é•¿&#34;</span><span class="p">,</span>
  <span class="nt">&#34;hiredate&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;1981-11-16T16:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;sal&#34;</span> <span class="p">:</span> <span class="mf">5000.0</span><span class="p">,</span>
  <span class="nt">&#34;depno&#34;</span> <span class="p">:</span> <span class="mf">10.0</span>
<span class="p">}</span>
<span class="p">{</span>
  <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="err">ObjectId(</span><span class="s2">&#34;5941f5bfc1bc86928f4de4b5&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;empno&#34;</span> <span class="p">:</span> <span class="mf">7844.0</span><span class="p">,</span>
  <span class="nt">&#34;ename&#34;</span> <span class="p">:</span> <span class="s2">&#34;é˜å©†æƒœ&#34;</span><span class="p">,</span>
  <span class="nt">&#34;job&#34;</span> <span class="p">:</span> <span class="s2">&#34;é”€å”®&#34;</span><span class="p">,</span>
  <span class="nt">&#34;mgr&#34;</span> <span class="p">:</span> <span class="mf">7698.0</span><span class="p">,</span>
  <span class="nt">&#34;hiredate&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;1981-09-07T16:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;sal&#34;</span> <span class="p">:</span> <span class="mf">1500.0</span><span class="p">,</span>
  <span class="nt">&#34;comm&#34;</span> <span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
  <span class="nt">&#34;depno&#34;</span> <span class="p">:</span> <span class="mf">30.0</span>
<span class="p">}</span>
<span class="p">{</span>
  <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="err">ObjectId(</span><span class="s2">&#34;5941f5bfc1bc86928f4de4b6&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;empno&#34;</span> <span class="p">:</span> <span class="mf">7876.0</span><span class="p">,</span>
  <span class="nt">&#34;ename&#34;</span> <span class="p">:</span> <span class="s2">&#34;æé€µ&#34;</span><span class="p">,</span>
  <span class="nt">&#34;job&#34;</span> <span class="p">:</span> <span class="s2">&#34;èŒå‘˜&#34;</span><span class="p">,</span>
  <span class="nt">&#34;mgr&#34;</span> <span class="p">:</span> <span class="mf">7902.0</span><span class="p">,</span>
  <span class="nt">&#34;hiredate&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;1987-07-12T16:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;sal&#34;</span> <span class="p">:</span> <span class="mf">1100.0</span><span class="p">,</span>
  <span class="nt">&#34;depno&#34;</span> <span class="p">:</span> <span class="mf">20.0</span>
<span class="p">}</span>
<span class="p">{</span>
  <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="err">ObjectId(</span><span class="s2">&#34;5941f5bfc1bc86928f4de4b7&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;empno&#34;</span> <span class="p">:</span> <span class="mf">7900.0</span><span class="p">,</span>
  <span class="nt">&#34;ename&#34;</span> <span class="p">:</span> <span class="s2">&#34;æ­¦æ¾&#34;</span><span class="p">,</span>
  <span class="nt">&#34;job&#34;</span> <span class="p">:</span> <span class="s2">&#34;èŒå‘˜&#34;</span><span class="p">,</span>
  <span class="nt">&#34;mgr&#34;</span> <span class="p">:</span> <span class="mf">7782.0</span><span class="p">,</span>
  <span class="nt">&#34;hiredate&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;1981-12-02T16:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;sal&#34;</span> <span class="p">:</span> <span class="mf">950.0</span><span class="p">,</span>
  <span class="nt">&#34;depno&#34;</span> <span class="p">:</span> <span class="mf">10.0</span>
<span class="p">}</span>
<span class="p">{</span>
  <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="err">ObjectId(</span><span class="s2">&#34;5941f5bfc1bc86928f4de4b8&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;empno&#34;</span> <span class="p">:</span> <span class="mf">7902.0</span><span class="p">,</span>
  <span class="nt">&#34;ename&#34;</span> <span class="p">:</span> <span class="s2">&#34;å´ç”¨&#34;</span><span class="p">,</span>
  <span class="nt">&#34;job&#34;</span> <span class="p">:</span> <span class="s2">&#34;åˆ†æå¸ˆ&#34;</span><span class="p">,</span>
  <span class="nt">&#34;mgr&#34;</span> <span class="p">:</span> <span class="mf">7566.0</span><span class="p">,</span>
  <span class="nt">&#34;hiredate&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;1981-12-02T16:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;sal&#34;</span> <span class="p">:</span> <span class="mf">3000.0</span><span class="p">,</span>
  <span class="nt">&#34;depno&#34;</span> <span class="p">:</span> <span class="mf">20.0</span>
<span class="p">}</span>
<span class="p">{</span>
  <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="err">ObjectId(</span><span class="s2">&#34;5941f5bfc1bc86928f4de4b9&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;empno&#34;</span> <span class="p">:</span> <span class="mf">7934.0</span><span class="p">,</span>
  <span class="nt">&#34;ename&#34;</span> <span class="p">:</span> <span class="s2">&#34;é²æ™ºæ·±&#34;</span><span class="p">,</span>
  <span class="nt">&#34;job&#34;</span> <span class="p">:</span> <span class="s2">&#34;èŒå‘˜&#34;</span><span class="p">,</span>
  <span class="nt">&#34;mgr&#34;</span> <span class="p">:</span> <span class="mf">7782.0</span><span class="p">,</span>
  <span class="nt">&#34;hiredate&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;1982-01-22T16:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;sal&#34;</span> <span class="p">:</span> <span class="mf">1300.0</span><span class="p">,</span>
  <span class="nt">&#34;depno&#34;</span> <span class="p">:</span> <span class="mf">10.0</span>
<span class="p">}</span>

</code></pre></div><p>dept</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="err">ObjectId(</span><span class="s2">&#34;5941f2bac1bc86928f4de49a&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;deptno&#34;</span> <span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
  <span class="nt">&#34;dname&#34;</span> <span class="p">:</span> <span class="s2">&#34;è´¢åŠ¡éƒ¨&#34;</span><span class="p">,</span>
  <span class="nt">&#34;loc&#34;</span> <span class="p">:</span> <span class="s2">&#34;åŒ—äº¬&#34;</span>
<span class="p">}</span>
<span class="p">{</span>
  <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="err">ObjectId(</span><span class="s2">&#34;5941f2bac1bc86928f4de49b&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;deptno&#34;</span> <span class="p">:</span> <span class="mf">20.0</span><span class="p">,</span>
  <span class="nt">&#34;dname&#34;</span> <span class="p">:</span> <span class="s2">&#34;åŠå…¬å®¤&#34;</span><span class="p">,</span>
  <span class="nt">&#34;loc&#34;</span> <span class="p">:</span> <span class="s2">&#34;ä¸Šæµ·&#34;</span>
<span class="p">}</span>
<span class="p">{</span>
  <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="err">ObjectId(</span><span class="s2">&#34;5941f2bac1bc86928f4de49c&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;deptno&#34;</span> <span class="p">:</span> <span class="mf">30.0</span><span class="p">,</span>
  <span class="nt">&#34;dname&#34;</span> <span class="p">:</span> <span class="s2">&#34;é”€å”®éƒ¨&#34;</span><span class="p">,</span>
  <span class="nt">&#34;loc&#34;</span> <span class="p">:</span> <span class="s2">&#34;å¹¿å·&#34;</span>
<span class="p">}</span>
<span class="p">{</span>
  <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="err">ObjectId(</span><span class="s2">&#34;5941f2bac1bc86928f4de49d&#34;</span><span class="err">)</span><span class="p">,</span>
  <span class="nt">&#34;deptno&#34;</span> <span class="p">:</span> <span class="mf">40.0</span><span class="p">,</span>
  <span class="nt">&#34;dname&#34;</span> <span class="p">:</span> <span class="s2">&#34;è¿è¥éƒ¨&#34;</span><span class="p">,</span>
  <span class="nt">&#34;loc&#34;</span> <span class="p">:</span> <span class="s2">&#34;æ·±åœ³&#34;</span>
<span class="p">}</span>

</code></pre></div><h2 id="æ’åºå’ŒæŠ•å½±">æ’åºå’ŒæŠ•å½±<a hidden class="anchor" aria-hidden="true" href="#æ’åºå’ŒæŠ•å½±">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">// æŸ¥è¯¢æ–‡æ¡£æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯æŒ‰ç…§_idçš„å€¼è¿›è¡Œæ’åˆ—(å‡åº)
</span><span class="c1">//sort()å¯ä»¥ç”¨æ¥æŒ‡å®šæ–‡æ¡£çš„æ’åºçš„è§„åˆ™ï¼Œsort()éœ€è¦ä¼ é€’ä¸€ä¸ªå¯¹è±¡æ¥æŒ‡å®šæ’åºè§„åˆ™ 1è¡¨ç¤ºå‡åº -1è¡¨ç¤ºé™åº
</span><span class="c1">//limit skip sort å¯ä»¥ä»»æ„çš„é¡ºåºè¿›è¡Œè°ƒç”¨
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">emp</span><span class="p">.</span><span class="nx">find</span><span class="p">({}).</span><span class="nx">sort</span><span class="p">({</span><span class="nx">sal</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>

<span class="c1">//åœ¨æŸ¥è¯¢æ—¶ï¼Œå¯ä»¥åœ¨ç¬¬äºŒä¸ªå‚æ•°çš„ä½ç½®æ¥è®¾ç½®æŸ¥è¯¢ç»“æœçš„ æŠ•å½±
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">emp</span><span class="p">.</span><span class="nx">find</span><span class="p">({},</span> <span class="p">{</span><span class="nx">ename</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">_</span><span class="nx">id</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">sal</span><span class="o">:</span> <span class="mi">1</span><span class="p">});</span>
</code></pre></div><h2 id="nodeæ•´åˆmongodb--mongoose">nodeæ•´åˆmongodb- Mongoose<a hidden class="anchor" aria-hidden="true" href="#nodeæ•´åˆmongodb--mongoose">#</a></h2>
<p><a href="http://mongoosejs.com/">http://mongoosejs.com/</a></p>
<h3 id="è¿æ¥æ•°æ®åº“">è¿æ¥æ•°æ®åº“<a hidden class="anchor" aria-hidden="true" href="#è¿æ¥æ•°æ®åº“">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="cm">/*
</span><span class="cm">  1. ä¸‹è½½å®‰è£…Mongoose
</span><span class="cm">    npm i mongoose --save
</span><span class="cm">  2. åœ¨é¡¹ç›®ä¸­å¼•å…¥mongoose
</span><span class="cm">    var mongoose = require(&#34;mongoose&#34;)
</span><span class="cm">  3. è¿æ¥MongoDBæ•°æ®åº“
</span><span class="cm">    mongoose.connect(&#39;mongodb://localhost:27017/test&#39;, {useMongoClient: true});
</span><span class="cm">    - å¦‚æœç«¯å£å·æ˜¯é»˜è®¤ç«¯å£å·(27017) åˆ™å¯ä»¥çœç•¥ä¸å†™
</span><span class="cm">
</span><span class="cm">  4. æ–­å¼€æ•°æ®åº“è¿æ¥(ä¸€èˆ¬ä¸éœ€è¦è°ƒç”¨)
</span><span class="cm">    - MongoDBæ•°æ®åº“ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåªéœ€è¦è¿æ¥ä¸€æ¬¡ï¼Œè¿æ¥ä¸€æ¬¡ä»¥åï¼Œé™¤éé¡¹ç›®åœæ­¢ï¼ŒæœåŠ¡å™¨å…³é—­ï¼Œå¦åˆ™è¿æ¥ä¸€èˆ¬ä¸ä¼šæ–­å¼€
</span><span class="cm">      mongoose.disconnect()
</span><span class="cm">  - ç›‘å¬MongoDBæ•°æ®åº“çš„è¿æ¥çŠ¶æ€
</span><span class="cm">    - åœ¨Mongooseå¯¹è±¡ä¸­ï¼Œæœ‰ä¸€ä¸ªå±æ€§å«åšConnectionï¼Œè¯¥å¯¹è±¡è¡¨ç¤ºçš„å°±æ˜¯æ•°æ®åº“è¿æ¥
</span><span class="cm">      é€šè¿‡ç›‘è§†è¯¥å¯¹è±¡çš„çŠ¶æ€ï¼Œå¯ä»¥æ¥ç›‘å¬æ•°æ®åº“çš„è¿æ¥ä¸æ–­å¼€
</span><span class="cm">
</span><span class="cm">      æ•°æ®åº“è¿æ¥æˆåŠŸçš„äº‹ä»¶
</span><span class="cm">      mongoose.connection.once(&#34;open&#34;, function());
</span><span class="cm">
</span><span class="cm">      æ•°æ®åº“æ–­å¼€çš„äº‹ä»¶
</span><span class="cm">      mongoose.connection.once(&#34;close&#34;, function());
</span><span class="cm">
</span><span class="cm">      Schema
</span><span class="cm">      Model
</span><span class="cm">      Document
</span><span class="cm">*/</span>
<span class="c1">// å¼•å…¥
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">mongoose</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;mongoose&#34;</span><span class="p">);</span>
<span class="c1">// è¿æ¥æ•°æ®åº“
</span><span class="c1">// mongoose.connect(&#34;mongodb://127.0.0.1/mongoose_test&#34;, { useNewUrlParser: true } );
</span><span class="c1"></span><span class="nx">mongoose</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="s1">&#39;mongodb://localhost:27017/test&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">useNewUrlParser</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">useUnifiedTopology</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">});</span>

<span class="nx">mongoose</span><span class="p">.</span><span class="nx">connection</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s2">&#34;open&#34;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;æ•°æ®åº“è¿æ¥æˆåŠŸ~~~~~&#34;</span><span class="p">);</span>
<span class="p">});</span>
<span class="nx">mongoose</span><span class="p">.</span><span class="nx">connection</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s2">&#34;close&#34;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;æ•°æ®åº“å·²ç»æ–­å¼€~~~~~&#34;</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">//æ–­å¼€æ•°æ®åº“è¿æ¥
</span><span class="c1"></span><span class="nx">mongoose</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">()</span>
</code></pre></div><h3 id="ä½¿ç”¨ç¤ºä¾‹">ä½¿ç”¨ç¤ºä¾‹<a hidden class="anchor" aria-hidden="true" href="#ä½¿ç”¨ç¤ºä¾‹">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">mongoose</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;mongoose&#34;</span><span class="p">);</span>
<span class="nx">mongoose</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="s2">&#34;mongodb://localhost/mongoose_test&#34;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">useNewUrlParser</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">useUnifiedTopology</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="p">});</span>

<span class="c1">// åˆ›å»ºSchema(æ¨¡å¼å¯¹è±¡)
</span><span class="c1"></span><span class="kd">var</span> <span class="p">{</span>
  <span class="nx">Schema</span>
<span class="p">}</span> <span class="o">=</span> <span class="nx">mongoose</span>
<span class="kd">var</span> <span class="nx">stuSchema</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Schema</span><span class="p">({</span>
  <span class="nx">name</span><span class="o">:</span> <span class="nb">String</span><span class="p">,</span>
  <span class="nx">age</span><span class="o">:</span> <span class="nb">Number</span><span class="p">,</span>
  <span class="nx">gender</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">type</span><span class="o">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="k">default</span><span class="o">:</span> <span class="s2">&#34;female&#34;</span>
  <span class="p">},</span>
  <span class="nx">address</span><span class="o">:</span> <span class="nb">String</span>
<span class="p">})</span>

<span class="c1">// é€šè¿‡Schemaæ¥åˆ›å»ºModel
</span><span class="c1">// Modelä»£è¡¨çš„æ˜¯æ•°æ®åº“ä¸­çš„é›†åˆï¼Œé€šè¿‡Modelæ‰èƒ½å¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œ
</span><span class="c1">// mongoose.model(modelName, schema);
</span><span class="c1">// modelName å°±æ˜¯è¦æ˜ å°„çš„é›†åˆå mongooseä¼šè‡ªåŠ¨è½¬æ¢æˆå¤æ•°
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">StuModel</span> <span class="o">=</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">model</span><span class="p">(</span><span class="s2">&#34;student&#34;</span><span class="p">,</span> <span class="nx">stuSchema</span><span class="p">)</span>

<span class="c1">// å‘æ•°æ®åº“ä¸­æ’å…¥ä¸€ä¸ªæ–‡æ¡£
</span><span class="c1">// StuModel.create(doc, function)); 
</span><span class="c1"></span><span class="nx">StuModel</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;ç™½éª¨ç²¾&#34;</span><span class="p">,</span>
  <span class="nx">age</span><span class="o">:</span> <span class="mi">18</span><span class="p">,</span>
  <span class="nx">address</span><span class="o">:</span> <span class="s2">&#34;ç™½éª¨æ´&#34;</span>
<span class="p">},</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;æ’å…¥æˆåŠŸ&#34;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div><h3 id="modelä½¿ç”¨">Modelä½¿ç”¨<a hidden class="anchor" aria-hidden="true" href="#modelä½¿ç”¨">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">mongoose</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;mongoose&#34;</span><span class="p">);</span>
<span class="nx">mongoose</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="s2">&#34;mongodb://localhost/mongoose_test&#34;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">useNewUrlParser</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">useUnifiedTopology</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="p">});</span>

<span class="c1">// åˆ›å»ºSchema(æ¨¡å¼å¯¹è±¡)
</span><span class="c1"></span><span class="kd">var</span> <span class="p">{</span>
  <span class="nx">Schema</span>
<span class="p">}</span> <span class="o">=</span> <span class="nx">mongoose</span>
<span class="kd">var</span> <span class="nx">stuSchema</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Schema</span><span class="p">({</span>
  <span class="nx">name</span><span class="o">:</span> <span class="nb">String</span><span class="p">,</span>
  <span class="nx">age</span><span class="o">:</span> <span class="nb">Number</span><span class="p">,</span>
  <span class="nx">gender</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">type</span><span class="o">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="k">default</span><span class="o">:</span> <span class="s2">&#34;female&#34;</span>
  <span class="p">},</span>
  <span class="nx">address</span><span class="o">:</span> <span class="nb">String</span>
<span class="p">})</span>

<span class="c1">// é€šè¿‡Schemaæ¥åˆ›å»ºModel
</span><span class="c1">// Modelä»£è¡¨çš„æ˜¯æ•°æ®åº“ä¸­çš„é›†åˆï¼Œé€šè¿‡Modelæ‰èƒ½å¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œ
</span><span class="c1">// mongoose.model(modelName, schema);
</span><span class="c1">// modelName å°±æ˜¯è¦æ˜ å°„çš„é›†åˆå mongooseä¼šè‡ªåŠ¨è½¬æ¢æˆå¤æ•°
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">StuModel</span> <span class="o">=</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">model</span><span class="p">(</span><span class="s2">&#34;student&#34;</span><span class="p">,</span> <span class="nx">stuSchema</span><span class="p">)</span>

<span class="cm">/*
</span><span class="cm">  - æœ‰äº†Modelï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨æ¥å¯¹æ•°æ®åº“è¿›è¡Œå¢åˆ æ”¹æŸ¥çš„æ“ä½œäº†
</span><span class="cm">  Model.create(doc(s), [callback])
</span><span class="cm">  - ç”¨æ¥åˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªæ–‡æ¡£å¹¶æ·»åŠ åˆ°æ•°æ®åº“ä¸­
</span><span class="cm">  - å‚æ•°ï¼š
</span><span class="cm">    doc(s) å¯ä»¥æ˜¯ä¸€ä¸ªæ–‡æ¡£å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ–‡æ¡£å¯¹è±¡çš„æ•°ç»„
</span><span class="cm">    callback å½“æ“ä½œå®Œæˆä»¥åè°ƒç”¨çš„å›è°ƒå‡½æ•°
</span><span class="cm">  æŸ¥è¯¢çš„:
</span><span class="cm">  Model.find(conditions, [projection], [options], [callback])
</span><span class="cm">    - æŸ¥è¯¢æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£
</span><span class="cm">  Model.findById(id, [projection], [options], [callback])
</span><span class="cm">    - æ ¹æ®æ–‡æ¡£çš„idå±æ€§æŸ¥è¯¢æ–‡æ¡£
</span><span class="cm">  Model.findOne([conditions], [projection], [options], [callback])
</span><span class="cm">    - æŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„ç¬¬ä¸€ä¸ªæ–‡æ¡£ï¼Œæ€»ä¼šè¿”å›ä¸€ä¸ªå…·ä½“çš„æ–‡æ¡£
</span><span class="cm">
</span><span class="cm">    conditions æŸ¥è¯¢çš„æ¡ä»¶
</span><span class="cm">    projection æŠ•å½± éœ€è¦çš„å­—æ®µ
</span><span class="cm">      - ä¸¤ç§æ–¹å¼
</span><span class="cm">          {name: 1, _id: 0}
</span><span class="cm">          &#34;name -_id&#34;
</span><span class="cm">    options æŸ¥è¯¢é€‰é¡¹(skip, limit)
</span><span class="cm">    callback å›è°ƒå‡½æ•°ï¼ŒæŸ¥è¯¢ç»“æœä¼šé€šè¿‡å›è°ƒå‡½æ•°è¿”å›
</span><span class="cm">            å›è°ƒå‡½æ•°å¿…é¡»ä¼ ï¼Œå¦‚æœä¸ä¼ å›è°ƒå‡½æ•°ï¼Œä¸ä¼šæŸ¥è¯¢
</span><span class="cm">*/</span>
<span class="c1">// StuModel.find({}, &#34;name age&#34;, {
</span><span class="c1">//   skip: 3,
</span><span class="c1">//   limit: 1
</span><span class="c1">// }, (err, docs) =&gt; {
</span><span class="c1">//   if (!err) {
</span><span class="c1">//     console.log(docs);
</span><span class="c1">//   }
</span><span class="c1">// })
</span><span class="c1">// StuModel.findOne({}, (err, docs) =&gt; {
</span><span class="c1">//   if (!err) {
</span><span class="c1">//     console.log(docs);
</span><span class="c1">//   }
</span><span class="c1">// })
</span><span class="c1">// StuModel.findById(&#34;60dbdbb2ecd64b4db4605b27&#34;, (err, docs) =&gt; {
</span><span class="c1">//   if (!err) {
</span><span class="c1">//     // console.log(docs);
</span><span class="c1">//     // é€šè¿‡find()æŸ¥è¯¢çš„ç»“æœï¼Œè¿”å›çš„å¯¹è±¡ï¼Œå°±æ˜¯Documentï¼Œæ–‡æ¡£å¯¹è±¡
</span><span class="c1">//     // Documentå¯¹è±¡æ˜¯Modelçš„å®ä¾‹
</span><span class="c1">//     console.log(docs instanceof StuModel);
</span><span class="c1">//   }
</span><span class="c1">// })
</span><span class="c1"></span>
<span class="c1">// StuModel.create([{
</span><span class="c1">//   name: &#34;æ²™å’Œå°š&#34;,
</span><span class="c1">//   age: 28,
</span><span class="c1">//   gender: &#34;male&#34;,
</span><span class="c1">//   address: &#34;æµæ²™æ²³&#34;
</span><span class="c1">// }], (error) =&gt; {
</span><span class="c1">//   if (!error) {
</span><span class="c1">//     console.log(arguments);
</span><span class="c1">//   }
</span><span class="c1">// })
</span><span class="c1"></span>
<span class="cm">/*
</span><span class="cm">  ä¿®æ”¹
</span><span class="cm">  Model.update(conditions, doc, [options], [callback])
</span><span class="cm">  Model.updateMany(conditions, doc, [options], [callback])
</span><span class="cm">  Model.updateOne(conditions, doc, [options], [callback])
</span><span class="cm">  Model.replaceOne(conditions, doc, [options], [callback])
</span><span class="cm">    - ç”¨æ¥ä¿®æ”¹ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡æ¡£
</span><span class="cm">    - å‚æ•°ï¼š 
</span><span class="cm">      conditions æŸ¥è¯¢æ¡ä»¶
</span><span class="cm">      doc ä¿®æ”¹åçš„å¯¹è±¡
</span><span class="cm">      options é…ç½®å‚æ•°
</span><span class="cm">      callback å›è°ƒå‡½æ•°
</span><span class="cm">*/</span>

<span class="c1">// ä¿®æ”¹å”åƒ§çš„å¹´é¾„ä¸º20
</span><span class="c1">// StuModel.updateOne({
</span><span class="c1">//   name: &#34;å”åƒ§&#34;
</span><span class="c1">// }, {
</span><span class="c1">//   $set: {
</span><span class="c1">//     age: 20
</span><span class="c1">//   }
</span><span class="c1">// }, (err) =&gt; {
</span><span class="c1">//   if (!err) {
</span><span class="c1">//     console.log(&#34;ä¿®æ”¹æˆåŠŸ&#34;);
</span><span class="c1">//   }
</span><span class="c1">// })
</span><span class="c1"></span>
<span class="cm">/*
</span><span class="cm">  åˆ é™¤
</span><span class="cm">  Model.remove(conditions, [callback])
</span><span class="cm">  Model.deleteOne(conditions, [callback])
</span><span class="cm">  Model.deleteMany(conditions, [callback])
</span><span class="cm"> */</span>

<span class="c1">// StuModel.deleteOne({
</span><span class="c1">//     name: &#34;æ²™å’Œå°š&#34;
</span><span class="c1">//   },
</span><span class="c1">//   err =&gt; {
</span><span class="c1">//     if (!err) {
</span><span class="c1">//       console.log(&#34;åˆ é™¤æˆåŠŸ&#34;);
</span><span class="c1">//     }
</span><span class="c1">//   })
</span><span class="c1"></span>
<span class="cm">/*
</span><span class="cm">  Model.count(conditions, [callback])
</span><span class="cm">    - ç»Ÿè®¡æ–‡æ¡£çš„æ•°é‡çš„
</span><span class="cm">*/</span>
<span class="nx">StuModel</span><span class="p">.</span><span class="nx">count</span><span class="p">({},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">count</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">count</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div><h3 id="documentä½¿ç”¨">Documentä½¿ç”¨<a hidden class="anchor" aria-hidden="true" href="#documentä½¿ç”¨">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="cm">/*
</span><span class="cm">  Document å’Œ é›†åˆä¸­çš„æ–‡æ¡£ä¸€ä¸€å¯¹åº”ï¼ŒDocumentæ˜¯Modelå®ä¾‹
</span><span class="cm">    é€šè¿‡ModelæŸ¥è¯¢åˆ°ç»“æœéƒ½æ˜¯Document
</span><span class="cm">*/</span>
<span class="c1">// åˆ›å»ºä¸€ä¸ªDocument
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">mongoose</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;mongoose&#34;</span><span class="p">);</span>
<span class="nx">mongoose</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="s2">&#34;mongodb://localhost/mongoose_test&#34;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">useNewUrlParser</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">useUnifiedTopology</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="p">});</span>

<span class="c1">// åˆ›å»ºSchema(æ¨¡å¼å¯¹è±¡)
</span><span class="c1"></span><span class="kd">var</span> <span class="p">{</span>
  <span class="nx">Schema</span>
<span class="p">}</span> <span class="o">=</span> <span class="nx">mongoose</span>
<span class="kd">var</span> <span class="nx">stuSchema</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Schema</span><span class="p">({</span>
  <span class="nx">name</span><span class="o">:</span> <span class="nb">String</span><span class="p">,</span>
  <span class="nx">age</span><span class="o">:</span> <span class="nb">Number</span><span class="p">,</span>
  <span class="nx">gender</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">type</span><span class="o">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="k">default</span><span class="o">:</span> <span class="s2">&#34;female&#34;</span>
  <span class="p">},</span>
  <span class="nx">address</span><span class="o">:</span> <span class="nb">String</span>
<span class="p">})</span>
<span class="c1">// é€šè¿‡Schemaæ¥åˆ›å»ºModel
</span><span class="c1">// Modelä»£è¡¨çš„æ˜¯æ•°æ®åº“ä¸­çš„é›†åˆï¼Œé€šè¿‡Modelæ‰èƒ½å¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œ
</span><span class="c1">// mongoose.model(modelName, schema);
</span><span class="c1">// modelName å°±æ˜¯è¦æ˜ å°„çš„é›†åˆå mongooseä¼šè‡ªåŠ¨è½¬æ¢æˆå¤æ•°
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">StuModel</span> <span class="o">=</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">model</span><span class="p">(</span><span class="s2">&#34;student&#34;</span><span class="p">,</span> <span class="nx">stuSchema</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">stu</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">StuModel</span><span class="p">({</span>
  <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;å¥”æ³¢éœ¸&#34;</span><span class="p">,</span>
  <span class="nx">age</span><span class="o">:</span> <span class="mi">48</span><span class="p">,</span>
  <span class="nx">gender</span><span class="o">:</span> <span class="s2">&#34;male&#34;</span><span class="p">,</span>
  <span class="nx">address</span><span class="o">:</span> <span class="s2">&#34;ç¢§æ³¢æ½­&#34;</span>
<span class="p">});</span>
<span class="cm">/*
</span><span class="cm">  documentçš„æ–¹æ³•
</span><span class="cm">    Model#save([options], [fn])
</span><span class="cm">*/</span>
<span class="c1">// stu.save(err =&gt; {
</span><span class="c1">//   if (!err) {
</span><span class="c1">//     console.log(&#34;ä¿å­˜æˆåŠŸ&#34;);
</span><span class="c1">//   }
</span><span class="c1">// })
</span><span class="c1"></span><span class="nx">StuModel</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({},</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">doc</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/*
</span><span class="cm">      update(update,[options],[callback])
</span><span class="cm">        -- ä¿®æ”¹å¯¹è±¡
</span><span class="cm">      remove([callback])
</span><span class="cm">        -- åˆ é™¤å¯¹è±¡
</span><span class="cm">    */</span>
    <span class="c1">// console.log(doc);
</span><span class="c1"></span>    <span class="c1">// doc.update({
</span><span class="c1"></span>    <span class="c1">//   $set: {
</span><span class="c1"></span>    <span class="c1">//     age: 28
</span><span class="c1"></span>    <span class="c1">//   }
</span><span class="c1"></span>    <span class="c1">// }, err =&gt; {
</span><span class="c1"></span>    <span class="c1">//   if (!err) {
</span><span class="c1"></span>    <span class="c1">//     console.log(&#34;ä¿®æ”¹æˆåŠŸ&#34;);
</span><span class="c1"></span>    <span class="c1">//   }
</span><span class="c1"></span>    <span class="c1">// })
</span><span class="c1"></span>    <span class="c1">// doc.remove(err =&gt; {
</span><span class="c1"></span>    <span class="c1">//   if (!err) {
</span><span class="c1"></span>    <span class="c1">//     console.log(&#34;å¤§å¸ˆå…„å†è§&#34;);
</span><span class="c1"></span>    <span class="c1">//   }
</span><span class="c1"></span>    <span class="c1">// })
</span><span class="c1"></span>    <span class="cm">/*
</span><span class="cm">      get(name)
</span><span class="cm">        -è·å–æ–‡æ¡£ä¸­çš„æŒ‡å®šå±æ€§å€¼
</span><span class="cm">      set()
</span><span class="cm">      id
</span><span class="cm">        - è·å–æ–‡æ¡£çš„_idå±æ€§å€¼
</span><span class="cm">      toJSON()
</span><span class="cm">        - è½¬æ¢ä¸ºä¸€ä¸ªJSONå­—ç¬¦ä¸²
</span><span class="cm">      toObject()
</span><span class="cm">        - å°†Documentè½¬æ¢æˆæ™®é€šçš„JSONå¯¹è±¡
</span><span class="cm">      
</span><span class="cm">    */</span>
    <span class="c1">// console.log(doc.get(&#34;age&#34;));
</span><span class="c1"></span>    <span class="c1">// console.log(doc.age);
</span><span class="c1"></span>    <span class="c1">// doc.set(&#34;name&#34;, &#34;çŒªğŸ–&#34;)
</span><span class="c1"></span>    <span class="c1">// doc.name = &#34;å“ˆå“ˆå“ˆ&#34;
</span><span class="c1"></span>
    <span class="nx">doc</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">toObject</span><span class="p">();</span>
    <span class="k">delete</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">address</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">doc</span><span class="p">);</span>

  <span class="p">}</span>
<span class="p">})</span>
</code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://rex0520.github.io/tags/nosql/">NoSQL</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://rex0520.github.io/posts/back/java/microservices/dubbo%E5%9F%BA%E7%A1%80/">
    <span class="title">Â« Prev Page</span>
    <br>
    <span>DubboåŸºç¡€</span>
  </a>
  <a class="next" href="https://rex0520.github.io/posts/back/java/microservices/docker%E5%9F%BA%E7%A1%80/">
    <span class="title">Next Page Â»</span>
    <br>
    <span>DockeråŸºç¡€</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share MongodbåŸºç¡€ on twitter"
        href="https://twitter.com/intent/tweet/?text=Mongodb%e5%9f%ba%e7%a1%80&amp;url=https%3a%2f%2frex0520.github.io%2fposts%2fnosql%2fmongodb%2f&amp;hashtags=NoSQL">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share MongodbåŸºç¡€ on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2frex0520.github.io%2fposts%2fnosql%2fmongodb%2f&amp;title=Mongodb%e5%9f%ba%e7%a1%80&amp;summary=Mongodb%e5%9f%ba%e7%a1%80&amp;source=https%3a%2f%2frex0520.github.io%2fposts%2fnosql%2fmongodb%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share MongodbåŸºç¡€ on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2frex0520.github.io%2fposts%2fnosql%2fmongodb%2f&title=Mongodb%e5%9f%ba%e7%a1%80">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share MongodbåŸºç¡€ on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2frex0520.github.io%2fposts%2fnosql%2fmongodb%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share MongodbåŸºç¡€ on whatsapp"
        href="https://api.whatsapp.com/send?text=Mongodb%e5%9f%ba%e7%a1%80%20-%20https%3a%2f%2frex0520.github.io%2fposts%2fnosql%2fmongodb%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share MongodbåŸºç¡€ on telegram"
        href="https://telegram.me/share/url?text=Mongodb%e5%9f%ba%e7%a1%80&amp;url=https%3a%2f%2frex0520.github.io%2fposts%2fnosql%2fmongodb%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
<script src="https://utteranc.es/client.js" repo="Rex0520/blogcomment"
  issue-term="title" theme="github-light" crossorigin="anonymous"
  async>
  </script>

</article>
    </main>
    
<footer class="footer">
  <span>&copy; 2021 <a href="https://rex0520.github.io/">Rex</a></span>
  <span>
    Powered by
    <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
    <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
  </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
    <path d="M12 6H0l6-6z" />
  </svg>
</a>

<script>
  let menu = document.getElementById('menu')
  menu.scrollLeft = localStorage.getItem("menu-scroll-position");
  menu.onscroll = function () {
    localStorage.setItem("menu-scroll-position", menu.scrollLeft);
  }

  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener("click", function (e) {
      e.preventDefault();
      var id = this.getAttribute("href").substr(1);
      if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
        document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
          behavior: "smooth"
        });
      } else {
        document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
      }
      if (id === "top") {
        history.replaceState(null, null, " ");
      } else {
        history.pushState(null, null, `#${id}`);
      }
    });
  });

</script>
<script>
  var mybutton = document.getElementById("top-link");
  window.onscroll = function () {
    if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
      mybutton.style.visibility = "visible";
      mybutton.style.opacity = "1";
    } else {
      mybutton.style.visibility = "hidden";
      mybutton.style.opacity = "0";
    }
  };

</script>
<script>
  document.getElementById("theme-toggle").addEventListener("click", () => {
    if (document.body.className.includes("dark")) {
      document.body.classList.remove('dark');
      localStorage.setItem("pref-theme", 'light');
    } else {
      document.body.classList.add('dark');
      localStorage.setItem("pref-theme", 'dark');
    }
  })

</script>
<script>
  document.querySelectorAll('pre > code').forEach((codeblock) => {
    const container = codeblock.parentNode.parentNode;

    const copybutton = document.createElement('button');
    copybutton.classList.add('copy-code');
    copybutton.innerText = 'copy';

    function copyingDone() {
      copybutton.innerText = 'copied!';
      setTimeout(() => {
        copybutton.innerText = 'copy';
      }, 2000);
    }

    copybutton.addEventListener('click', (cb) => {
      if ('clipboard' in navigator) {
        navigator.clipboard.writeText(codeblock.textContent);
        copyingDone();
        return;
      }

      const range = document.createRange();
      range.selectNodeContents(codeblock);
      const selection = window.getSelection();
      selection.removeAllRanges();
      selection.addRange(range);
      try {
        document.execCommand('copy');
        copyingDone();
      } catch (e) { };
      selection.removeRange(range);
    });

    if (container.classList.contains("highlight")) {
      container.appendChild(copybutton);
    } else if (container.parentNode.firstChild == container) {
      
    } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
      
      codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
    } else {
      
      codeblock.parentNode.appendChild(copybutton);
    }
  });
</script>

<script src="/assets/js/mermaid.min.js"></script>
<script>
  
  
  const mermaidKeywords = [
    "graph TD",
    "graph TB",
    "graph BT",
    "graph RL",
    "graph LR",
    "sequenceDiagram",
    "gantt",
    "classDiagram",
    "gitGraph",
    "erDiagram",
    "journey"
  ];
  var col = document.querySelector('.language-fallback');
  var htmlCollection = document.getElementsByClassName('language-fallback')
  console.log(col)
  console.log(htmlCollection)
  Array.prototype.slice.call(htmlCollection)
  console.log(Array.prototype.slice.call(htmlCollection))
  Array.from(htmlCollection).forEach(ele => {
    var graphDefinition = ele.innerText;
    if (mermaidKeywords.some((keyword) => graphDefinition.startsWith(keyword))) {
      ele.parentElement.parentElement.outerHTML = `<div class="mermaid">${ele.innerText}</div>`
    }
  })
  Array.from(document.getElementsByClassName('language-mermaid')).forEach(ele => {
    ele.parentElement.outerHTML = `<div class="mermaid">${ele.innerText}</div>`
  })
</script>
<style>
   
  .mermaid svg {
    display: block;
    margin: auto;
  }
</style></body>

</html>
